## Primary DNS Server

The primary DNS server is the server of the zone file, which contains all authoritative information for a domain and is responsible for administering this zone. The DNS records of a zone can only be edited on the primary DNS server, which then updates the secondary DNS servers.

---

## Secondary DNS Server

Secondary DNS servers contain read-only copies of the zone file from the primary DNS server. These servers compare their data with the primary DNS server at regular intervals and thus serve as a backup server. It is useful because a primary name server's failure means that connections without name resolution are no longer possible. To establish connections anyway, the user would have to know the IP addresses of the contacted servers. Nevertheless, this is not the rule.

---

## Zone Files

We already know that the zone files contain the corresponding records and information for the specific domain. Here we distinguish between:

- `Primary zone` (`master zone`)
- `Secondary zone` (`slave zone`)

The `secondary zone` on the secondary DNS server serves as a substitute for the `primary zone` on the primary DNS server if the primary DNS server should become unreachable. The creation and transfer of the `primary zone` copy from the primary DNS server to the secondary DNS server is called a "`zone transfer`."

The update of the zone files can only be done on the primary DNS server, which then updates the secondary DNS server. Each zone file can have only one primary DNS server and an unlimited number of secondary DNS servers.

We can also consider the TLD "`.com`," such as a company manager for a specific department, who only knows and manages his team leaders (`Zone 1`). Each team leader also knows only his manager and his team members (`Zone 2` and `Zone 3`).

#### Zone 1

  DNS Zones

```shell-session
.
└── com.
    ├── domain-A.
    ├── domain-B.
    └── domain-C.
```

#### Zone 2

  DNS Zones

```shell-session
com.
└── domain-A.
    ├── blog.
    ├── ns1.
    └── www.
```

#### Zone 3

  DNS Zones

```shell-session
com.
└── domain-B.
    └── www2.
```

---

## Zone Transfer

There are two different types of zone transfers.

- `AXFR` - Asynchronous Full Transfer Zone
- `IXFR` - Incremental Zone Transfer

An `AXFR` is a complete transfer of all entries of the zone file. In contrast to full asynchronous transfer, only the changed and new DNS records of the zone file are transferred for an `IXFR` to the secondary DNS servers.

The problem with DNS servers and zone transfers is that it does not require authentication and can be requested by any client. If the administrator has not set "Trusted Hosts/IP addresses" for the DNS servers, which have permission to receive these zones, we can also query the entire zone file with its contents. This will give us all IP addresses with the respective hosts and significantly increase our attack vector if the agreement does not limit our scope. Even today, it is quite common that the DNS servers are misconfigured and allow this.

**Credit:** This information was adapted from an excellent guide on [HTB Academy](https://academy.hackthebox.com/course/preview/dns-enumeration-using-python). Be sure to check out the original post for more details.
