# Impacket

[](https://github.com/fortra/impacket#impacket)

[![Latest Version](https://camo.githubusercontent.com/e60927e5079351185ff40d1ed051fc8f452490ecdf227b5b57c31eb54a7f43a2/68747470733a2f2f696d672e736869656c64732e696f2f707970692f762f696d7061636b65742e737667)](https://pypi.python.org/pypi/impacket/)¬†[![Build and test Impacket](https://github.com/fortra/impacket/actions/workflows/build_and_test.yml/badge.svg)](https://github.com/fortra/impacket/actions/workflows/build_and_test.yml)

FORTRA. Copyright (C) 2023 Fortra. All rights reserved.

Impacket was originally created by¬†[SecureAuth](https://www.secureauth.com/labs/open-source-tools/impacket), and now maintained by Fortra's Core Security.

Impacket is a collection of Python classes for working with network protocols. Impacket is focused on providing low-level programmatic access to the packets and for some protocols (e.g. SMB1-3 and MSRPC) the protocol implementation itself. Packets can be constructed from scratch, as well as parsed from raw data, and the object-oriented API makes it simple to work with deep hierarchies of protocols. The library provides a set of tools as examples of what can be done within the context of this library.

## What protocols are featured?

[](https://github.com/fortra/impacket#what-protocols-are-featured)

- Ethernet, Linux "Cooked" capture.
- IP, TCP, UDP, ICMP, IGMP, ARP.
- IPv4 and IPv6 Support.
- NMB and SMB1, SMB2 and SMB3 (high-level implementations).
- MSRPC version 5, over different transports: TCP, SMB/TCP, SMB/NetBIOS and HTTP.
- Plain, NTLM and Kerberos authentications, using password/hashes/tickets/keys.
- Portions/full implementation of the following MSRPC interfaces: EPM, DTYPES, LSAD, LSAT, NRPC, RRP, SAMR, SRVS, WKST, SCMR, BKRP, DHCPM, EVEN6, MGMT, SASEC, TSCH, DCOM, WMI, OXABREF, NSPI, OXNSPI.
- Portions of TDS (MSSQL) and LDAP protocol implementations.

# Maintainer

[](https://github.com/fortra/impacket#maintainer)

[Core Security](https://www.coresecurity.com/)

# Table of Contents

[](https://github.com/fortra/impacket#table-of-contents)

- [Getting Impacket](https://github.com/fortra/impacket#getting-impacket)
- [Setup](https://github.com/fortra/impacket#setup)
- [Testing](https://github.com/fortra/impacket#testing)
- [Licensing](https://github.com/fortra/impacket#licensing)
- [Disclaimer](https://github.com/fortra/impacket#disclaimer)
- [Contact Us](https://github.com/fortra/impacket#contact-us)

# Getting Impacket

[](https://github.com/fortra/impacket#getting-impacket)

### Latest version

[](https://github.com/fortra/impacket#latest-version)

- Impacket v0.11.0
    
    [![Python versions](https://camo.githubusercontent.com/4fe08ea2e1bad54b899e004c14e4247f9d3e4a24a7846cf476cec18412df97e9/68747470733a2f2f696d672e736869656c64732e696f2f707970692f707976657273696f6e732f696d7061636b65742e737667)](https://pypi.python.org/pypi/impacket/)
    

[Current and past releases](https://github.com/fortra/impacket/releases)

### Development version

[](https://github.com/fortra/impacket#development-version)

- Impacket v0.12.0-dev (**[master branch](https://github.com/fortra/impacket/tree/master)**)
    
    [![Python versions](https://camo.githubusercontent.com/bdcf2df29cc36934f6f0560ae4404b10b167ca71bc4cf344e1fbd9dbac89f046/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f707974686f6e2d332e36253230253743253230332e37253230253743253230332e38253230253743253230332e39253230253743253230332e31302d626c75652e737667)](https://github.com/fortra/impacket/tree/master)
    

# Setup

[](https://github.com/fortra/impacket#setup)

### Quick start

[](https://github.com/fortra/impacket#quick-start)

> ‚ÑπÔ∏è We recommend using¬†`pipx`¬†over¬†`pip`¬†for system-wide installations.

In order to grab the latest stable release run:

```
python3 -m pipx install impacket
```

If you want to play with the unreleased changes, download the development version from the¬†[master branch](https://github.com/fortra/impacket/tree/master), extract the package, and execute the following command from the directory where Impacket has been unpacked:

```
python3 -m pipx install .
```

### Docker Support

[](https://github.com/fortra/impacket#docker-support)

Build Impacket's image:

```
  $ docker build -t "impacket:latest" .
```

Using Impacket's image:

```
  $ docker run -it --rm "impacket:latest"
```

# Testing

[](https://github.com/fortra/impacket#testing)

The library leverages the¬†[pytest](https://docs.pytest.org/)¬†framework for organizing and marking test cases,¬†[tox](https://tox.readthedocs.io/)¬†to automate the process of running them across supported Python versions, and¬†[coverage](https://coverage.readthedocs.io/)¬†to obtain coverage statistics.

A¬†[comprehensive testing guide](https://github.com/fortra/impacket/blob/master/TESTING.md)¬†is available.

# Licensing

[](https://github.com/fortra/impacket#licensing)

This software is provided under a slightly modified version of the Apache Software License. See the accompanying¬†[LICENSE](https://github.com/fortra/impacket/blob/master/LICENSE)¬†file for more information.

SMBv1 and NetBIOS support based on Pysmb by Michael Teo.

# Disclaimer

[](https://github.com/fortra/impacket#disclaimer)

The spirit of this Open Source initiative is to help security researchers, and the community, speed up research and educational activities related to the implementation of networking protocols and stacks.

The information in this repository is for research and educational purposes and not meant to be used in production environments and/or as part of commercial products.

If you desire to use this code or some part of it for your own uses, we recommend applying proper security development life cycle and secure coding practices, as well as generate and track the respective indicators of compromise according to your needs.

# Contact Us

[](https://github.com/fortra/impacket#contact-us)

Whether you want to report a bug, send a patch, or give some suggestions on this package, reach out to us at¬†[https://www.coresecurity.com/about/contact](https://www.coresecurity.com/about/contact).

For security-related questions check our¬†[security policy](https://github.com/fortra/impacket/blob/master/SECURITY.md).

**Credit:**¬†This information was adapted from an excellent guide on¬†[GitHub](https://github.com/fortra/impacket). Be sure to check out the original post for more details.

# Brace for Impacket!

## Detecting a Red Team (and Threat Actor) Favorite

# Introduction and Objectives

In this article we‚Äôll take on the mighty¬†[Impacket](https://attack.mitre.org/software/S0357/), an open-source Python library for conducting network-based attacks. This is not some obscure, boutique offensive tool; as the folks at RedCanary showed in their wonderful¬†[2023 Threat Detection Report](https://redcanary.com/threat-detection-report/threats/impacket/), Impacket was the second most prevalent threat that they observed last year, affecting more than one in twenty of their customers!

![](https://miro.medium.com/v2/resize:fit:650/1*js9NnsfTkZC94sb6HBmmew.png)

Image Credit: RedCanary 2023 Threat Detection Report

Impacket is popular with both legitimate penetration testers and Red Teamers, as well as cybercriminals and their counterparts in foreign adversary government hacking teams. I first heard about Impacket way back in 2020 while watching TheCyberMentor‚Äôs iconic ‚Äú[Zero to Hero Pentesting](https://www.youtube.com/watch?v=qlK174d_uu8&list=RDCMUC0ArlFuFYMpEewyRBzdLHiw&index=1)‚Äù series, which is still worth checking out!

My objectives for this article are:

1. üë®‚Äçüè´ Understand Impacket basics, and examine what we know about how Impacket tools are used by malign actors.
2. üìã Review the tools that make up the Impacket suite by showing a couple of well-known Impacket tools in action.
3. üî≠ Explore some of the lesser-known Impacket tools and how we might detect them (hopefully without a ton of false positives).
4. ‚úçÔ∏è Along the way, document some easily-shareable Sigma rules so that you can try these detection concepts out in your environment.

# Quick Disclaimer

I am not claiming this to be the first nor the best article about Impacket detection‚Ää‚Äî‚Ääfar from it! As stated above, my primary objective is education (both yours and mine) about Impacket, it‚Äôs event log and network artifacts, and how we can identify use of Impacket, responding before harm befalls our network. As always, I‚Äôll provide plenty of links, mentions, and references to my favorite resources on the topic, so that you can explore what I consider to be the highest-quality, foundational resources for understanding and detecting Impacket.

![](https://miro.medium.com/v2/resize:fit:498/0*72jLm4xfOpAJfgoR.gif)

L2 SOC Analyst SquarePants initiating a P1 callout for Impacket activity.

# Impacket 101

So, what exactly is Impacket, and why is it so popular? A good starting point is the GitHub repo that houses the project:

[

## GitHub - fortra/impacket: Impacket is a collection of Python classes for working with network‚Ä¶

### FORTRA. Copyright (C) 2022 Fortra. All rights reserved. Impacket was originally created by SecureAuth, and now‚Ä¶

github.com



](https://github.com/fortra/impacket?source=post_page-----5191dff82c74--------------------------------)

According to the project main page:

> Impacket is a collection of Python classes for working with network protocols. Impacket is focused on providing low-level programmatic access to the packets and for some protocols (e.g. SMB1‚Äì3 and MSRPC) the protocol implementation itself. Packets can be constructed from scratch, as well as parsed from raw data, and the object-oriented API makes it simple to work with deep hierarchies of protocols. The library provides a set of tools as examples of what can be done within the context of this library.

Hmmm‚Ä¶ ü§î Respectfully, this is not the most helpful description, at least from my point of view! For me, a far more helpful resources for gaining a quick, high-level understanding of Impacket is¬†[this page](https://www.secureauth.com/labs/open-source-tools/impacket/), which offers summaries of each of the many Impacket CLI-style Python script modules contained within the project‚Äôs¬†[examples](https://github.com/fortra/impacket/tree/master/examples)¬†folder. These ‚Äúexamples‚Äù include tools for execution, Kerberos ticket manipulation, credential access, adversary-in-the-middle style relay attacks, and more. Truly, Impacket‚Äôs examples folder contains tools covering a veritable potpourri of the Mitre ATT&CK Framework!

![](https://miro.medium.com/v2/resize:fit:667/0*1r-zJjKiihFsS6bv.jpg)

Here‚Äôs a key point for defenders: While Impacket is often advertised as offering low-level programmatic access to network protocols, it is most commonly used by threat actors and pen testers in it‚Äôs higher-level module/scripts form‚Ää‚Äî‚Ääat least according to the hacking guides and threat intel reports I‚Äôve found that include Impacket. Another way of saying this is, while Impacket offers enterprising attackers to build their own race car using it‚Äôs own granular set of nuts and bolts, most users simply choose one of the default options from the examples folder. Please drop a comment if you are aware of the documented use of Impacket base classes, which differ from the well-known example scripts!

## Use of Impacket by Threat Actors

If Impacket is a well-loved tool among legitimate red teamers and pen testers, then what do we know about Impacket use by our adversaries, the malicious threat actors who keep us up at night (or keep us employed, depending on how you look at it üòè)? Over the course of a very brief web search I found numerous authoritative examples of criminal or espionage organizations using Impacket, including many from the past six months. A couple of notable examples include:

- [Unnamed criminals using Impacket in an effort to deliver Ursnif malware (The DFIRReport, January 2023)](https://thedfirreport.com/2023/01/09/unwrapping-ursnifs-gifts/)
- [Unnamed APT targeting the defense industry using Impacket (CISA, October 2022)](https://www.cisa.gov/news-events/cybersecurity-advisories/aa22-277a)
- [ViceSociety criminal organization using Impacket to deliver ransomware to education organizations (Microsoft, October 2022)](https://www.microsoft.com/en-us/security/blog/2022/10/25/dev-0832-vice-society-opportunistic-ransomware-campaigns-impacting-us-education-sector/)

# Understanding Impacket‚Äôs Capabilities

It‚Äôs worth noting that all of these threat intel reports (as well as most others I found) only mention Impacket tools which fall within the ‚ÄúExecution‚Äù category of Impacket‚Äôs example script tools. These include wmiexec.py, atexec.py, and smbexec.py. I‚Äôm not sure exactly why these particular tools get the majority of the threat intel ‚Äúlove‚Äù but it could be because the other tools are harder to detect, less relevant to threat actors‚Äô overall goals, or simply weren‚Äôt as interesting to the authors of the blogs and reports I read.

Let‚Äôs refer back to the helpful Impacket page from SecureAuth below:

[

## Impacket

### Impacket is a collection of Python classes for working with network protocols. Impacket is focused on providing‚Ä¶

www.secureauth.com



](https://www.secureauth.com/labs/open-source-tools/impacket/?source=post_page-----5191dff82c74--------------------------------)

We can see that Impacket contains lots of tools that go beyond simply executing commands on a remote host. Kerberos attacks, relay attacks, credential theft, MSSQL enumeration, and others also fall within Impacket‚Äôs scope. Just as the blogs and threat intel reports I found tend to focus on execution tools like wmiexec, the available detection rules and resources (one of my favorites from 13 Cubed can be found here) I found covering Impacket also seem to focus on detecting these tools. Makes sense, right?

So, to try to keep this blog post educational without retreading too much well-covered ground, I‚Äôll next demonstrate some of Impacket‚Äôs better-known tools, and then we‚Äôll take a crack at detecting some of Impacket‚Äôs lesser-documented tools! Let‚Äôs do this! üèÅüèÅüèÅ

# Impacket Does Remote Execution

Impacket can be run either on a remote ‚Äúattacker‚Äù machine, such as one running Kali Linux, or on a local host in your lab if you don‚Äôt want to run Kali alongside your Windows lab VMs. Bear in mind that Impacket‚Äôs tools are heavily targeted towards an Active Directory environment, so for the best results, you should target a system running as part of an AD domain.

## wmiexec.py

Here‚Äôs a straightforward example, in this case using wmiexec.py to execute the whoami command from a Kali machine, targeting my Windows host at 192.168.56.102:

![](https://miro.medium.com/v2/resize:fit:628/1*P7QCkdoSb3vWjJTxQaQKdg.png)

Classic wmiexec.py usage

Then, using a Splunk search to list processes created on my target host, I can see a burst of cmd.exe activity spawned by the WMI Script Provider Host (WmiPrvSE.exe):

![](https://miro.medium.com/v2/resize:fit:700/1*Jjp-ZStO1GLUu59pg6u9Gg.png)

Note the tell-tale command lines resulting from this tool

Note the command line strings, whereby it appears that the result is directed to an admin share. These command lines are very specific to Impacket and considered one of the best ways to detect ‚Äúoff the shelf‚Äù Impacket usage. This helpful and robust Sigma rule uses these command line elements in tandem with other indicators to detect wmiexec and several of it‚Äôs execution-related Impacket cousins:

[

## sigma/proc_creation_win_hktl_impacket_lateral_movement.yml at master ¬∑ SigmaHQ/sigma

### Main Sigma Rule Repository. Contribute to SigmaHQ/sigma development by creating an account on GitHub.

github.com



](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_hktl_impacket_lateral_movement.yml?source=post_page-----5191dff82c74--------------------------------)

We can test the rule in our lab by first saving it, then converting it using sigma-cli:

![](https://miro.medium.com/v2/resize:fit:700/1*cybqwyAC0l-DFpnwxNcNJA.png)

Using Sigma-CLI to convert the Impacket rule (note, I‚Äôve changed the file name to test_rule.yml)

‚Ä¶and then running a slightly adapted version of the resulting query in our lab‚Äôs Splunk search app:

![](https://miro.medium.com/v2/resize:fit:700/1*EaPqzEje0m4UlNenhjjVvA.png)

The Sigma rule reliably detects Impacket execution

Sure enough, all of the recent hammering on wmiexec.py in my lab is picked up by the search!

## atexec.py

Let‚Äôs try out another interesting execution-focused Impacket tool: atexec. This tool uses the deprecated¬†[at.exe](https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/at)¬†to create a scheduled task which runs the user-supplied command, runs the task, then immediately deletes the task. Sneaky!

![](https://miro.medium.com/v2/resize:fit:606/1*_ew1GtQhNSA6eDoFqcZoBw.png)

atexec.py in action ‚Äî scheduled tasks run using old-school at.exe

Interestingly, when I ran atexec.py in my lab against the DC, the Sigma rule referenced earlier (HackTool ‚Äî Potential Impacket Lateral Movement Activity) did¬†_not_¬†detect this activity. This may be because of deficiencies in the audit settings in my lab; however, I was able to create a set of rules to reliably detect atexec.py activity using windows event log process creation events (event 4688), sysmon file creation events, sysmon registry events, and the scheduled task log:

[

## Sigma-Rules/2023_Impacket/atexec at main ¬∑ mbabinski/Sigma-Rules

### You can't perform that action at this time. You signed in with another tab or window. You signed out in another tab or‚Ä¶

github.com



](https://github.com/mbabinski/Sigma-Rules/tree/main/2023_Impacket/atexec?source=post_page-----5191dff82c74--------------------------------)

Below is an example Sigma rule which will reliably detect atexec.py usage using event 4688, with command line auditing catching the presence of a suspicious .tmp file stored in a temp folder, which contains the output of the attacker command:

title: Impacket AtExec Process Activity  
id: ceccdcd7-ab57-407c-bd8f-78b2427eb283  
status: experimental  
description: Detect Atexec.py (Impacket) usage to send command output to attacker.  
references:  
    - https://www.13cubed.com/downloads/impacket_exec_commands_cheat_sheet.pdf  
    - https://www.hackingarticles.in/impacket-guide-smb-msrpc/  
author: Micah Babinski  
date: 2023/01/08  
tags:  
    - attack.s0357  
    - attack.execution  
    - attack.t1053  
    - attack.t1053.002  
logsource:  
    product: windows  
    service: security  
detection:  
    selection:  
        EventID: 4688  
        NewProcessName|endswith: '\cmd.exe'  
        CommandLine|contains|all|windash:  
            - 'cmd.exe'  
            - '/c'  
            - 2>&1  
        CommandLine|re: '^.*Temp\\[A-Za-z]{8}\.tmp.*$'  
    condition: selection  
falsepositives:  
    - Unknown  
level: high

## **Impacket‚Äôs Other Execution-Related Tools**

I encourage you to explore Impacket‚Äôs other execution-focused tools (psexec.py, dcomexec.py, and smbexec.py), both with an eye towards the telemetry generated by running the tools, and with the desire to understand the underlying mechanics of how the tools operate. For instance, I found psexec.py to be an interesting technique for abusing Windows services, and it helped me better understand how service-related data is captured both within the Windows¬†[System](https://windows-event-explorer.app.elstc.co/publisher/Service%20Control%20Manager/event/7045/v0)¬†and¬†[Security](https://windows-event-explorer.app.elstc.co/publisher/Microsoft-Windows-Security-Auditing/event/4697/v1)¬†logs.

# Impacket Steals Credentials

Now that we have an essential Impacket execution tool under our belt, let‚Äôs move on to some of the deeper cuts: the Impacket utilities designed for more subtle, incremental attacks, starting with credential theft.

## secretsdump.py

Secretsdump.py uses a grab bag of techniques to retrieve credential secrets from a target, including cached credentials from the registry, NTDS.DIT, and Kerberos keys. All of this is achieved with a very light footprint on the target host, because no malware is actually running there. A network monitoring solution like Zeek is well-suited to the task, however! Zeek can monitor the Distributed Computing Environment/Remote Procedure Call (DCE/RPC) activity in your network, which will record a fairly-distinct trail of activity left by secretsdump.py.

I won‚Äôt pretend to understand this stuff all that well (if you are knowledgeable please recommend some good reading on this topic in the comments!), but from what I read, the Microsoft Directory Replication Service (DRSUAPI) uses DCE/RPC to implement replication between domain controllers. Secretsdump.py works in part by abusing this service endpoint, requesting user credentials using the GetNCChanges method. While this activity may include legitimate domain controller replication, it also provides a network-based detection concept for secretsdump.py.

title: Possible Impacket Secretsdump.py Activity  
id: 8d1476b7-0f57-43a4-b56b-50bfab66943d  
status: experimental  
description: Detects attempts to retrieve/dump credentials using the DL_DRSGetNCChanges() method.  
references:  
    - https://www.extrahop.com/company/blog/2021/dcsync-definition-and-protection/  
    - https://www.secureauth.com/labs/open-source-tools/impacket/  
    - https://wiki.samba.org/index.php/DRSUAPI  
    - https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-drsr/9b4bfb44-6656-4404-bcc8-dc88111658b3  
author: Micah Babinski  
date: 2023/04/13  
tags:  
    - attack.s0357  
    - attack.credential_access  
    - attack.t1003  
    - attack.t1003.003  
    - attack.t1003.006  
logsource:  
    product: zeek  
    service: dce_rpc  
detection:  
    selection:  
        operation: DRSGetNCChanges  
        endpoint: drsuapi  
        id.resp_p: 49666  
        named_pipe: '49666'  
    condition: selection  
fields:  
    - id.orig_h  
falsepositives:  
    - This may detect legitimate Active Directory domain control replication/sync activity (perhaps filter by inbound/outbound IP addresses of your known DCs)  
level: low

If you are new to Zeek, I highly recommend checking it out! I gained familiarity using this tutorial series from Kevin Thomas:

[

## Zeek Network Security Monitor Tutorial: Part 1 (Setup)

### Welcome to our beginner user-friendly Zeek Network Security Monitor series.

medium.com



](https://medium.com/@mytechnotalent/zeek-network-security-monitor-tutorial-part-1-setup-f0ac2fb8eba8?source=post_page-----5191dff82c74--------------------------------)

# Impacket Targets Kerberos

## GetUserSPNs.py

GetUserSPNs.py targets the Kerberos network authentication mechanism by reporting Service Principal Names (SPNs) associated with normal user accounts. These can in turn then be used to conduct Kerberoasting, an attack where the Ticket-Granting Ticket is used to obtain a vulnerable Ticket-Granting Service (TGS) ticket that can be brute forced.

In the example below, I‚Äôve used GetUserSPNs.py to retrieve the TGS for my vagrant user, whom I‚Äôve artificially added an SPN to using the setspn Windows command.

![](https://miro.medium.com/v2/resize:fit:700/1*P3N6xBnR95Hl7PIzZp1ITQ.png)

User SPN scooped up by Impacket GetUserSPNs.py

As this tool requests the ticket using the vulnerable RC4 HMAC encryption type (the one that can be brute forced), we have a couple of opportunities to detect this. One is to check out Windows event ID 4769, which records Kerberos service ticket requests, and filter for the vulnerable encryption type, stored as 0x7 in the log:

![](https://miro.medium.com/v2/resize:fit:700/1*s5N5cTSNpt6MUrVHKXJOUA.png)

Sketchy af Kerberos ticket request

Luckily, Florian Roth has this Sigma rule which can reliably detect this activity:

[

## sigma/win_security_susp_rc4_kerberos.yml at master ¬∑ SigmaHQ/sigma

### You can't perform that action at this time. You signed in with another tab or window. You signed out in another tab or‚Ä¶

github.com



](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_susp_rc4_kerberos.yml?source=post_page-----5191dff82c74--------------------------------)

On the network side, Zeek‚Äôs kerberos.log file can detect the transfer of the vulnerable TGS request from the attacker to the target DC. This provides another vantage point from which defenders can detect these credential access attempts:

![](https://miro.medium.com/v2/resize:fit:550/1*Who5l7QA5dt0DCrZP7znDw.png)

Who knew that Zeek could record Kerberos TGS requests?

A rule to detect this activity by monitoring Zeek data may look like this:

title: Possible Impacket GetUserSPNs Activity  
id: 73822599-97d8-411f-8ee1-e57ecac118c7  
status: experimental  
description: Detects attempts to create vulnerable Kerberos Ticket Granting Service (TGS) tickets using the RC4-HMAC encryption type.  
references:  
    - https://www.blackhillsinfosec.com/impacket-defense-basics-with-an-azure-lab/  
    - https://github.com/fortra/impacket/blob/impacket_0_10_0/examples/GetUserSPNs.py  
author: Micah Babinski  
date: 2023/04/13  
tags:  
    - attack.s0357  
    - attack.credential_access  
    - attack.t1558  
    - attack.t1558.003  
logsource:  
    product: zeek  
    service: kerberos  
detection:  
    selection:  
        cipher: 'rc4-hmac'  
        request_type: 'TGS'  
        success: true  
    condition: selection  
fields:  
    - id.orig_h  
    - client  
    - service  
falsepositives:  
    - Unknown  
level: low

# Impacket Can Upload Files to Vulnerable Systems

## smbclient.py

One of the coolest capabilities that Impacket offers is smbclient.py, which gives an attacker the ability to list, modify, create, upload, and download files on a remote system. This capability maps to several Mitre ATT&CK techniques, including Lateral Tool Transfer, Exfiltration Over Alternative Protocol, and File and Directory Discovery. The options for running smbclient.py are shown below:

![](https://miro.medium.com/v2/resize:fit:700/1*V4dmoxrLPTTbZexWiVqf5A.png)

Options for Impacket smbclient.py ‚Äî Impacket‚Äôs SMB Swiss army knife

After entering the interactive SMB session, you can list the various command options available to you by typing ‚Äúhelp.‚Äù In my lab, I emulated a process of using the SMB client to perform lateral tool transfer. After entering the SMB session using a compromised user (mcorrigan), I selected the C$ share, created a directory called ‚ÄúNothingToSeeHere,‚Äù and uploaded an empty file creatively called ‚Äúevil.exe‚Äù.

![](https://miro.medium.com/v2/resize:fit:206/1*88FToEVGUBMUnI4ccf-cOg.png)

Emulating lateral tool transfer with Impacket

Switching over the file explorer on my target machine, I can see that the evil.exe file is now present in the new directory:

![](https://miro.medium.com/v2/resize:fit:700/1*ZKKvEOx0FlGTKG7s-tZ2UA.png)

*Whistles innocently*

Let‚Äôs look and see what evidence has been left in our logs. From Sysmon event 11 (file event), I can see that the .exe file was created, although the user tagged in the log event is not mcorrigan, it‚Äôs NT AUTHORITY\SYSTEM:

![](https://miro.medium.com/v2/resize:fit:700/1*9fRJXVW-IrXF9eO9Xz3xJA.png)

File creation event resulting from the SMB client ‚Äúput‚Äù operation

Also, not that the ‚ÄúImage‚Äù field in the event shown above shows a value of ‚ÄúSystem‚Äù ‚Äî this is normally the process executable used to create the file. I wondered what would happen with the following SPL search:

index=sysmon EventCode=11 Image=System TargetFilename="*.exe" User="NT AUTHORITY\\SYSTEM"  
| table _time, ComputerName, User, Image, TargetFilename

Here I am looking for files created with an .exe extension, an image value of ‚ÄúSystem‚Äù and the user of ‚ÄúNT Authority\System‚Äù. I returned four records, and found that each one represented Impacket activity in my lab:

![](https://miro.medium.com/v2/resize:fit:700/1*1C4oe1uT5rui5tY1TbaPzw.png)

Sifting through file creation events scooped up my Impacket testing.

Of course, your mileage may vary, and the activity shown here might be normal in a given environment! Here‚Äôs the rule in Sigma format if you want to try it out, either as an alert or starting point for threat hunting:

title: Suspicious Exe File Event With System Image  
id: 2ace112a-1717-4648-b0f8-51796f36c58e  
status: experimental  
description: Detects potential SMB file creation activity associated with Impacket smbclient.py.  
references:  
    - https://github.com/fortra/impacket/blob/impacket_0_10_0/examples/smbclient.py  
author: Micah Babinski  
date: 2023/04/16  
tags:  
    - attack.lateral_movement  
    - attack.t1105  
logsource:  
    product: windows  
    category: file_event  
detection:  
    selection:  
        TargetFilename|endswith: '.exe'  
        Image: System  
        User: 'NT Authority\Sytem'  
    condition: selection  
falsepositives:  
    - Unknown  
level: low

The logon event for the user mcorrigan is also suspect, as it uses Logon Type 3 (network logon), and the vulnerable authentication package NTLM. In my lab, the Source Workstation Address is a private IP address, but in a real detection scenario, alerting on events matching these properties originating from public IP addresses would be a wise choice. You can adapt the following Sigma rule to accomplish this!

[

## sigma/win_security_successful_external_remote_smb_login.yml at master ¬∑ SigmaHQ/sigma

### Main Sigma Rule Repository. Contribute to SigmaHQ/sigma development by creating an account on GitHub.

github.com



](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_successful_external_remote_smb_login.yml?source=post_page-----5191dff82c74--------------------------------)

# Conclusion

Thus concludes our (slightly haphazard) tour of Impacket capabilities. I hope you‚Äôve learned some Impacket basics and also gained some insights into the non-execution capabilities of the library. I certainly have!

To be honest, I really struggled with the analysis and documentation of Impacket. This experience has revealed to me that I have a lot still to learn about the interplay network-based attacks and underlying Windows protocols. Throughout the writing, a familiar and frustrating pattern would emerge ‚Äî I would begin to explore an Impacket module, test it in the lab, write a little introductory paragraph, and then go to find evidence of the activity in my Splunk instance, only to find that I could not find anything distinguishable!

![](https://miro.medium.com/v2/resize:fit:498/1*Tz6u7JMLq09Y4eIdi3t4HQ.gif)

Footage of me looking for Impacket evidence in my lab.

Besides providing a pathway for further learning, this experience shows me why Impacket is such a useful and popular tool among legitimate pen testers and threat actors. If you have some thoughts on ways to expand my network-based detection capabilities, please let me know in the comments. I welcome feedback on my work in any form.

**Credit:**¬†This information was adapted from an excellent guide on¬†[Medium](https://micahbabinski.medium.com/brace-for-impacket-5191dff82c74). Be sure to check out the original post for more details.

# Impacket

We're excited to welcome Impacket to Fortra's¬†[open source portfolio](https://github.com/fortra/impacket). Formerly hosted by¬†[SecureAuth](https://www.secureauth.com/blog/a-new-chapter-in-secureauths-commitment-to-open-security-research-and-knowledge-sharing-a-new-home-for-impacket/), this tool will now be maintained by Fortra's Core Security. Core Security remains committed to Impacket's future development, as well as the development of the open-source ecosystem around it, enabling our community partners to enhance Impacket through contributions.

## What Is Impacket?

Impacket is a collection of Python classes for working with network protocols. Impacket is focused on providing low-level programmatic access to the packets and, for some protocols (e.g. SMB1-3 and MSRPC), the protocol implementation itself. Packets can be constructed from scratch, as well as parsed from raw data, and the object-oriented API makes it simple to work with deep hierarchies of protocols. The library provides a set of tools as examples of what can be done within the context of this library.

Impacket is available for download in Fortra's¬†[github library](https://github.com/fortra/impacket).

## Featured Protocols

- Ethernet, Linux ‚ÄúCooked‚Äù capture.
- IP, TCP, UDP, ICMP, IGMP, ARP.
- IPv4 and IPv6 Support.
- NMB and SMB1, SMB2 and SMB3 (high-level implementations).
- MSRPC version 5, over different transports: TCP, SMB/TCP, SMB/NetBIOS and HTTP.
- Plain, NTLM and Kerberos authentications, using password/hashes/tickets/keys.
- Portions/full implementation of the following MSRPC interfaces: EPM, DTYPES, LSAD, LSAT, NRPC, RRP, SAMR, SRVS, WKST, SCMR, DCOM, WMI
- Portions of TDS (MSSQL) and LDAP protocol implementations.

## Featured Tools

### Remote Execution

- [psexec.py:](https://github.com/fortra/impacket/blob/impacket_0_11_0/examples/psexec.py)¬†PSEXEC like functionality example using RemComSvc ([https://github.com/kavika13/RemCom](https://github.com/kavika13/RemCom)).
- [smbexec.py:](https://github.com/fortra/impacket/blob/impacket_0_11_0/examples/smbexec.py)¬†A similar approach to PSEXEC w/o using RemComSvc. The technique is described¬†[here](https://web.archive.org/web/20140625065218/http://blog.accuvant.com/rdavisaccuvant/owning-computers-without-shell-access/). Our implementation goes one step further, instantiating a local smbserver to receive the output of the commands. This is useful in the situation where the target machine does NOT have a writeable share available.
- [atexec.py:](https://github.com/fortra/impacket/blob/impacket_0_11_0/examples/atexec.py)¬†This example executes a command on the target machine through the Task Scheduler service and returns the output of the executed command.
- [wmiexec.py:](https://github.com/fortra/impacket/blob/impacket_0_10_0/examples/wmiexec.py)¬†A semi-interactive shell, used through Windows Management Instrumentation. It does not require to install any service/agent at the target server. Runs as Administrator. Highly stealthy.
- [dcomexec.py:](https://github.com/fortra/impacket/blob/impacket_0_11_0/examples/dcomexec.py)¬†A semi-interactive shell similar to wmiexec.py, but using different DCOM endpoints. Currently supports MMC20.Application, ShellWindows and ShellBrowserWindow objects.

### Kerberos

- [GetTGT.py:](https://github.com/fortra/impacket/blob/impacket_0_11_0/examples/getTGT.py)¬†Given a password, hash or aesKey, this script will request a TGT and save it as ccache.
- [GetST.py:](https://github.com/fortra/impacket/blob/impacket_0_11_0/examples/getST.py)¬†Given a password, hash, aesKey or TGT in ccache, this script will request a Service Ticket and save it as ccache. If the account has constrained delegation (with protocol transition) privileges you will be able to use the -impersonate switch to request the ticket on behalf another user.
- [GetPac.py:](https://github.com/fortra/impacket/blob/impacket_0_11_0/examples/getPac.py)¬†This script will get the PAC (Privilege Attribute Certificate) structure of the specified target user just having a normal authenticated user credentials. It does so by using a mix of [MS-SFU]‚Äôs S4USelf + User to User Kerberos Authentication.
- [GetUserSPNs.py:](https://github.com/fortra/impacket/blob/impacket_0_11_0/examples/GetUserSPNs.py)¬†This example will try to find and fetch Service Principal Names that are associated with normal user accounts. Output is compatible with JtR and HashCat.
- [GetNPUsers.py:](https://github.com/fortra/impacket/blob/impacket_0_11_0/examples/GetNPUsers.py)¬†This example will attempt to list and get TGTs for those users that have the property ‚ÄòDo not require Kerberos preauthentication‚Äô set (UF_DONT_REQUIRE_PREAUTH). Output is compatible with JtR.
- [rbcd.py](https://github.com/fortra/impacket/blob/impacket_0_11_0/examples/rbcd.py): Example script for handling the msDS-AllowedToActOnBehalfOfOtherIdentity property of a target computer.
- [ticketConverter.py](https://github.com/fortra/impacket/blob/impacket_0_9_24/examples/ticketConverter.py): This script will convert¬†kirbi files, commonly used by mimikatz, into ccache files used by Impacket, and vice versa.
- [ticketer.py:](https://github.com/fortra/impacket/blob/impacket_0_11_0/examples/ticketer.py)¬†This script will create Golden/Silver tickets from scratch or based on a template (legally requested from the KDC) allowing you to customize some of the parameters set inside the PAC_LOGON_INFO structure, in particular the groups, ExtraSids, duration, etc.
- [raiseChild.py:](https://github.com/fortra/impacket/blob/impacket_0_11_0/examples/raiseChild.py)¬†This script implements a child-domain to forest privilege escalation by (ab)using the concept of Golden Tickets and ExtraSids.

### Windows Secrets

- [secretsdump.py:](https://github.com/fortra/impacket/blob/impacket_0_11_0/examples/secretsdump.py)¬†Performs various techniques to dump secrets from the remote machine without executing any agent there. For SAM and LSA Secrets (including cached creds) we try to read as much as we can from the registry and then we save the hives in the target system (%SYSTEMROOT%\Temp directory) and read the rest of the data from there. For DIT files, we dump NTLM hashes, Plaintext credentials (if available) and Kerberos keys using the DL_DRSGetNCChanges() method. It can also dump NTDS.dit via vssadmin executed with the smbexec/wmiexec approach. The script initiates the services required for its working if they are not available (e.g. Remote Registry, even if it is disabled). After the work is done, things are restored to the original state.
- [mimikatz.py:](https://github.com/fortra/impacket/blob/impacket_0_11_0/examples/mimikatz.py)¬†Mini shell to control a remote mimikatz RPC server developed by @gentilkiwi.

### Server Tools/MiTM Attacks

- [ntlmrelayx.py:](https://github.com/fortra/impacket/blob/impacket_0_11_0/examples/ntlmrelayx.py)¬†This script performs NTLM Relay Attacks, setting an SMB, HTTP, WCF and RAW Server and relaying credentials to many different protocols (SMB, HTTP, MSSQL, LDAP, IMAP, POP3, etc.). The script can be used with predefined attacks that can be triggered when a connection is relayed (e.g. create a user through LDAP) or can be executed in SOCKS mode. In this mode, for every connection relayed, it will be available to be used later on multiple times through a SOCKS proxy.
- [karmaSMB.py:](https://github.com/fortra/impacket/blob/impacket_0_11_0/examples/karmaSMB.py)¬†A SMB Server that answers specific file contents regardless of the SMB share and pathname specified.
- [smbserver.py:](https://github.com/fortra/impacket/blob/impacket_0_11_0/examples/smbserver.py)¬†A Python implementation of an SMB server. Allows to quickly set up shares and user accounts.

### WMI

- [wmiquery.py:](https://github.com/fortra/impacket/blob/impacket_0_11_0/examples/wmiquery.py)¬†It allows to issue WQL queries and get description of WMI objects at the target system (e.g. select name from win32_account).
- [wmipersist.py:](https://github.com/fortra/impacket/blob/impacket_0_11_0/examples/wmipersist.py)¬†This script creates/removes a WMI Event Consumer/Filter and link between both to execute Visual Basic based on the WQL filter or timer specified.

### Known Vulnerabilities

- [goldenPac.py:](https://github.com/fortra/impacket/blob/impacket_0_11_0/examples/goldenPac.py)¬†Exploit for MS14-068. Saves the golden ticket and also launches a PSEXEC session at the target.
- [sambaPipe.py:](https://github.com/fortra/impacket/blob/impacket_0_11_0/examples/sambaPipe.py)¬†This script will exploit CVE-2017-7494, uploading and executing the shared library specified by the user through the -so parameter.
- [smbrelayx.py:](https://github.com/fortra/impacket/blob/impacket_0_11_0/examples/smbrelayx.py)¬†Exploit for CVE-2015-0005 using a SMB Relay Attack. If the target system is enforcing signing and a machine account was provided, the module will try to gather the SMB session key through NETLOGON.

### SMB/MSRPC

- [smbclient.py:](https://github.com/fortra/impacket/blob/impacket_0_11_0/examples/smbclient.py)¬†A generic SMB client that will let you list shares and files, rename, upload and download files and create and delete directories, all using either username and password or username and hashes combination. It‚Äôs an excellent example to see how to use impacket.smb in action.
- [addcomputer.py](https://github.com/fortra/impacket/blob/impacket_0_11_0/examples/addcomputer.py): Allows to add a computer to a domain using LDAP or SAMR (SMB).
- [getArch.py:](https://github.com/fortra/impacket/blob/impacket_0_10_0/examples/getArch.py)¬†This script will connect against a target (or list of targets) machine/s and gather the OS architecture type installed by (ab)using a documented MSRPC feature.
- [exchanger.py](https://github.com/fortra/impacket/blob/impacket_0_11_0/examples/exchanger.py): A tool for connecting to MS Exchange via RPC over HTTP v2.
- [lookupsid.py:](https://github.com/fortra/impacket/blob/impacket_0_11_0/examples/lookupsid.py)¬†A Windows SID brute forcer example through [MS-LSAT] MSRPC Interface, aiming at finding remote users/groups.
- [netview.py:](https://github.com/fortra/impacket/blob/impacket_0_11_0/examples/netview.py)¬†Gets a list of the sessions opened at the remote hosts and keep track of them looping over the hosts found and keeping track of who logged in/out from remote servers
- [reg.py:](https://github.com/fortra/impacket/blob/impacket_0_11_0/examples/reg.py)¬†Remote registry manipulation tool through the [MS-RRP] MSRPC Interface. The idea is to provide similar functionality as the REG.EXE Windows utility.
- [rpcdump.py:](https://github.com/fortra/impacket/blob/impacket_0_11_0/examples/rpcdump.py)¬†This script will dump the list of RPC endpoints and string bindings registered at the target. It will also try to match them with a list of well known endpoints.
- [rpcmap.py](https://github.com/fortra/impacket/blob/impacket_0_11_0/examples/rpcmap.py): Scan for listening DCE/RPC interfaces. This binds to the MGMT interface and gets a list of interface UUIDs. If the MGMT interface is not available, it takes a list of interface UUIDs seen in the wild and tries to bind to each interface.
- [samrdump.py:](https://github.com/fortra/impacket/blob/impacket_0_11_0/examples/samrdump.py)¬†An application that communicates with the Security Account Manager Remote interface from the MSRPC suite. It lists system user accounts, available resource shares and other sensitive information exported through this service.
- [services.py:](https://github.com/fortra/impacket/blob/impacket_0_11_0/examples/services.py)¬†This script can be used to manipulate Windows services through the [MS-SCMR] MSRPC Interface. It supports start, stop, delete, status, config, list, create and change.
- [smbpasswd.py](https://github.com/fortra/impacket/blob/impacket_0_11_0/examples/smbpasswd.py): This script is an alternative to smbpasswd tool and intended to be used for changing expired passwords remotely over SMB (MSRPC-SAMR
- [changepasswd.py](https://nam11.safelinks.protection.outlook.com/?url=https%3A%2F%2Fgithub.com%2Ffortra%2Fimpacket%2Fblob%2Fimpacket_0_11_0%2Fexamples%2Fchangepasswd.py&data=05%7C01%7Canna.rysavy%40fortra.com%7C7698656ba29c42b4e68008db97836ba0%7Cca81e23b350945eea9983e346acf274d%7C0%7C0%7C638270362951589233%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=OHllJjEUeLDNcY6n%2BfAmaMUtMX%2B1N6RKRzvLXYeZXJU%3D&reserved=0 "Direcci√≥n URL original: https://github.com/fortra/impacket/blob/impacket_0_11_0/examples/changepasswd.py. Haga clic o pulse si conf√≠a en este v√≠nculo."): Combining in one single place features to change or reset passwords over different protocols.
- [net.py](https://nam11.safelinks.protection.outlook.com/?url=https%3A%2F%2Fgithub.com%2Ffortra%2Fimpacket%2Fblob%2Fimpacket_0_11_0%2Fexamples%2Fnet.py&data=05%7C01%7Canna.rysavy%40fortra.com%7C7698656ba29c42b4e68008db97836ba0%7Cca81e23b350945eea9983e346acf274d%7C0%7C0%7C638270362951745477%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=4SnX6KXXWtWSPJQSILy9QDDjfPci3KX5ohgU%2F0vZCAI%3D&reserved=0 "Direcci√≥n URL original: https://github.com/fortra/impacket/blob/impacket_0_11_0/examples/net.py. Haga clic o pulse si conf√≠a en este v√≠nculo."): Impacket alternative for windows net.exe commandline utility. Thanks to RPC protocol, this tool is making net.exe functionalities available from remote computer.

### MSSQL/TDS

- [mssqlinstance.py:](https://github.com/fortra/impacket/blob/impacket_0_11_0/examples/mssqlinstance.py)¬†Retrieves the MSSQL instances names from the target host.
- [mssqlclient.py:](https://github.com/fortra/impacket/blob/impacket_0_11_0/examples/mssqlclient.py)¬†An MSSQL client, supporting SQL and Windows Authentications (hashes too). It also supports TLS.

### File Formats

- [esentutl.py:](https://github.com/fortra/impacket/blob/impacket_0_11_0/examples/esentutl.py)¬†An Extensibe Storage Engine format implementation. Allows dumping catalog, pages and tables of ESE databases (e.g. NTDS.dit)
- [ntfs-read.py:](https://github.com/fortra/impacket/blob/impacket_0_11_0/examples/ntfs-read.py)¬†NTFS format implementation. This script provides a mini shell for browsing and extracting an NTFS volume, including hidden/locked contents.
- [registry-read.py:](https://github.com/fortra/impacket/blob/impacket_0_11_0/examples/registry-read.py)¬†A Windwows Registry file format implementation. It allows to parse offline registry hives.

### Other

- [findDelegation.py](https://github.com/fortra/impacket/blob/impacket_0_11_0/examples/findDelegation.py): Simple script to quickly list all delegation relationships (unconstrained, constrained, resource-based constrained) in an AD environment.
- [GetADUsers.py:](https://github.com/fortra/impacket/blob/impacket_0_11_0/examples/GetADUsers.py)¬†This script will gather data about the domain‚Äôs users and their corresponding email addresses. It will also include some extra information about last logon and last password set attributes.
- [Get-GPPPassword.py](https://github.com/fortra/impacket/blob/impacket_0_11_0/examples/Get-GPPPassword.py): This example extracts and decrypts Group Policy Preferences passwords using streams for treating files instead of mounting shares. Additionally, it can parse GPP XML files offline.
- [mqtt_check.py:](https://github.com/fortra/impacket/blob/impacket_0_11_0/examples/mqtt_check.py)¬†Simple MQTT example aimed at playing with different login options. Can be converted into a account/password brute forcer quite easily.
- [rdp_check.py:](https://github.com/fortra/impacket/blob/impacket_0_11_0/examples/rdp_check.py)¬†[MS-RDPBCGR] and [MS-CREDSSP] partial implementation just to reach CredSSP auth. This example tests whether an account is valid on the target host.
- [sniff.py:](https://github.com/fortra/impacket/blob/impacket_0_11_0/examples/sniff.py)¬†Simple packet sniffer that uses the pcapy library to listen for packets in # transit over the specified interface.
- [sniffer.py:](https://github.com/fortra/impacket/blob/impacket_0_11_0/examples/sniffer.py)¬†Simple packet sniffer that uses a raw socket to listen for packets in transit corresponding to the specified protocols.
- [ping.py](https://github.com/fortra/impacket/blob/impacket_0_11_0/examples/ping.py): Simple ICMP ping that uses the ICMP echo and echo-reply packets to check the status of a host. If the remote host is up, it should reply to the echo probe with an echo-reply packet.
- [ping6.py:](https://github.com/fortra/impacket/blob/impacket_0_11_0/examples/ping6.py)¬†Simple IPv6 ICMP ping that uses the ICMP echo and echo-reply packets to check the status of a host.
- [DumpNTLMInfo.py](https://nam11.safelinks.protection.outlook.com/?url=https%3A%2F%2Fgithub.com%2Ffortra%2Fimpacket%2Fblob%2Fimpacket_0_11_0%2Fexamples%2FDumpNTLMInfo.py&data=05%7C01%7Canna.rysavy%40fortra.com%7C7698656ba29c42b4e68008db97836ba0%7Cca81e23b350945eea9983e346acf274d%7C0%7C0%7C638270362951745477%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=4DJ1hqtuFY3auhtjF7SKj1IA2mfkfKuW671ZbsFUp6w%3D&reserved=0 "Direcci√≥n URL original: https://github.com/fortra/impacket/blob/impacket_0_11_0/examples/DumpNTLMInfo.py. Haga clic o pulse si conf√≠a en este v√≠nculo."): it dumps remote host information in NTLM authentication model, without credentials for SMB protocols (1/2/3)

## Source Code

- You can check out trunk (development version) at¬†_[https://github.com/fortra/impacket](https://nam11.safelinks.protection.outlook.com/?url=https%3A%2F%2Fgithub.com%2Ffortra%2Fimpacket&data=05%7C01%7Ccatherine.zack%40fortra.com%7C0abc365eaa2b44286e4f08db97813fae%7Cca81e23b350945eea9983e346acf274d%7C0%7C0%7C638270353608210951%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=p7FRKw4q7UxrSbATo2W0k65SOo1efRClYmrs7BRiecQ%3D&reserved=0)_
- 0.10.0, updated on May4th, 2022 ‚Äì¬†[gzip‚Äôd tarball](https://github.com/fortra/impacket/releases/download/impacket_0_10_0/impacket-0.10.0.tar.gz)
- 0.9.24, updated on Oct 27th, 2021 ‚Äì¬†[gzip‚Äôd tarball](https://github.com/fortra/impacket/releases/download/impacket_0_9_24/impacket-0.9.24.tar.gz)
- 0.9.23, updated on Jun 9th, 2021 ‚Äì¬†[gzip‚Äôd tarball](https://github.com/fortra/impacket/releases/download/impacket_0_9_23/impacket-0.9.23.tar.gz)
- 0.9.22, updated on Nov 23th, 2020 ‚Äì¬†[gzip‚Äôd tarball](https://github.com/fortra/impacket/releases/download/impacket_0_9_22/impacket-0.9.22.tar.gz)
- 0.9.21, updated on Mar 26th, 2020 ‚Äì¬†[gzip‚Äôd tarball](https://github.com/fortra/impacket/releases/download/impacket_0_9_21/impacket-0.9.21.tar.gz)
- 0.9.20, updated on Sep 25th, 2019 ‚Äì¬†[gzip‚Äôd tarball](https://github.com/fortra/impacket/releases/download/impacket_0_9_20/impacket-0.9.20.tar.gz)
- 0.9.19, updated on Apr 1st, 2019 ‚Äì¬†[gzip‚Äôd tarball](https://github.com/fortra/impacket/releases/download/impacket_0_9_19/impacket-0.9.19.tar.gz)
- 0.9.18, updated on Dec 5th, 2018 ‚Äì¬†[gzip‚Äôd tarball](https://files.pythonhosted.org/packages/71/a5/f25ac0036c2b85e48aee740a99c3ab82196a05d8a4203fac6e8283ea5b0b/impacket-0.9.18.tar.gz)
- 0.9.17, updated on May 30th, 2018 ‚Äì¬†[gzip‚Äôd tarball](https://files.pythonhosted.org/packages/09/26/de84602349ca97b78d1720045db662c7eb261d2daf4a3b509b7ee387de74/impacket-0.9.17.tar.gz)
- 0.9.15, updated on Jun 28th, 2016 ‚Äì¬†[gzip‚Äôd tarball](https://pypi.python.org/packages/35/72/694c391c7fe29600c2c8d8d4aa97a781562c39bb66a3d20bbee9858ca698/impacket-0.9.15.tar.gz#md5=53fb6d1c375dd3ef8fff4ce2b7ff8f15)
- 0.9.14, updated on Jan 7th, 2016 ‚Äì¬†[gzip‚Äôd tarball](https://pypi.python.org/packages/source/i/impacket/impacket-0.9.14.tar.gz),
- 0.9.13, updated on May 4th, 2015 ‚Äì¬†[gzip‚Äôd tarball](https://pypi.python.org/packages/source/i/impacket/impacket-0.9.13.tar.gz),
- 0.9.12, updated on July 20th, 2014 ‚Äì¬†[gzip‚Äôd tarball](https://pypi.python.org/packages/source/i/impacket/impacket-0.9.12.tar.gz),
- 0.9.11, updated on Feb 3, 2014 ‚Äì¬†[gzip‚Äôd tarball](https://hsdownloads.helpsystems.com/coresecurity/impacket/impacket-0.9.11.tar_.gz?__hstc=220751815.04c20045aed7625fd6a7c32a034aec9c.1723765470796.1723765470796.1723765470796.1&__hssc=220751815.1.1723765470796&__hsfp=79320913),
- 0.9.10, updated on May 6, 2013 ‚Äì¬†[gzip‚Äôd tarball](https://hsdownloads.helpsystems.com/coresecurity/impacket/impacket-0.9.10.tar_.gz?__hstc=220751815.04c20045aed7625fd6a7c32a034aec9c.1723765470796.1723765470796.1723765470796.1&__hssc=220751815.1.1723765470796&__hsfp=79320913),
- 0.9.9.9, updated on July 20, 2012 ‚Äì¬†[gzip‚Äôd tarball](https://hsdownloads.helpsystems.com/coresecurity/impacket/impacket-0.9.9.9.tar_.gz?__hstc=220751815.04c20045aed7625fd6a7c32a034aec9c.1723765470796.1723765470796.1723765470796.1&__hssc=220751815.1.1723765470796&__hsfp=79320913),¬†[zip file](https://hsdownloads.helpsystems.com/coresecurity/impacket/impacket-0.9.9.9.zip?__hstc=220751815.04c20045aed7625fd6a7c32a034aec9c.1723765470796.1723765470796.1723765470796.1&__hssc=220751815.1.1723765470796&__hsfp=79320913)
- 0.9.6.0, updated on May 23, 2006 ‚Äì¬†[gzip‚Äôd tarball](https://hsdownloads.helpsystems.com/coresecurity/impacket/Impacket-0.9.6.0.tar_.gz?__hstc=220751815.04c20045aed7625fd6a7c32a034aec9c.1723765470796.1723765470796.1723765470796.1&__hssc=220751815.1.1723765470796&__hsfp=79320913)
- 0.9.5.2, updated on Apr 3, 2006 ‚Äì¬†[gzip‚Äôd tarball](https://hsdownloads.helpsystems.com/coresecurity/impacket/Impacket-0.9.5.2.tar_.gz?__hstc=220751815.04c20045aed7625fd6a7c32a034aec9c.1723765470796.1723765470796.1723765470796.1&__hssc=220751815.1.1723765470796&__hsfp=79320913),¬†[zip file](https://hsdownloads.helpsystems.com/coresecurity/impacket/Impacket-0.9.5.2.zip?__hstc=220751815.04c20045aed7625fd6a7c32a034aec9c.1723765470796.1723765470796.1723765470796.1&__hssc=220751815.1.1723765470796&__hsfp=79320913)
- 0.9.5.1, updated on Dec 16, 2003 ‚Äì¬†[gzip‚Äôd tarball](https://hsdownloads.helpsystems.com/coresecurity/impacket/Impacket-0.9.5.1.tar_.gz?__hstc=220751815.04c20045aed7625fd6a7c32a034aec9c.1723765470796.1723765470796.1723765470796.1&__hssc=220751815.1.1723765470796&__hsfp=79320913),¬†[zip file](https://hsdownloads.helpsystems.com/coresecurity/impacket/Impacket-0.9.5.1.zip?__hstc=220751815.04c20045aed7625fd6a7c32a034aec9c.1723765470796.1723765470796.1723765470796.1&__hssc=220751815.1.1723765470796&__hsfp=79320913)
- 0.11.0, updated on Aug 3rd, 2023 ‚Äì¬†[gzip‚Äôd tarball](https://nam11.safelinks.protection.outlook.com/?url=https%3A%2F%2Fgithub.com%2Ffortra%2Fimpacket%2Freleases%2Fdownload%2Fimpacket_0_11_0%2Fimpacket-0.11.0.tar.gz&data=05%7C01%7Canna.rysavy%40fortra.com%7C7698656ba29c42b4e68008db97836ba0%7Cca81e23b350945eea9983e346acf274d%7C0%7C0%7C638270362951745477%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=rTo88nfHu%2F%2Frb6sztsHNqoFI2Aj27672BypQUFnNoes%3D&reserved=0 "Direcci√≥n URL original: https://github.com/fortra/impacket/releases/download/impacket_0_11_0/impacket-0.11.0.tar.gz. Haga clic o pulse si conf√≠a en este v√≠nculo.")

## Setup

### Requirements

- [Python](http://www.python.org/)¬†interpreter (version 3.6, 3.7, 3.8, 3.9, or 3.10).
- [Third-party](https://github.com/fortra/impacket/blob/master/requirements.txt)¬†packages also needed.

### Installation

- Grab the latest stable release ([gzip‚Äôd tarbal](https://github.com/fortra/impacket/releases/download/impacket_0_9_24/impacket-0.9.24.tar.gz)), unpack it and run:¬†**python3 -m pip install .**¬†¬†from the directory where you placed it.¬† This will install the classes into the default Python modules path; note that you might need special permissions to write there.

### Docker Support

- Build Impacket‚Äôs image:¬†¬†**docker build -t ‚Äúimpacket:latest‚Äù .**
- Using Impacket‚Äôs image:¬†¬†**docker run -it ‚Äìrm ‚Äúimpacket:latest‚Äù**

## Documentation

Currently, limited documentation is included in the source as Python‚Äôs doc comments. You can also learn a lot about the library functionality through its¬†[test cases](https://github.com/fortra/impacket/tree/master/tests)¬†and¬†[examples](https://github.com/fortra/impacket/tree/master/examples).

## Related Information

Impacket is also closely tied to preexisting Core Security tools, such as the pen testing solution¬†[Core Impact](https://www.coresecurity.com/products/core-impact), serving as the foundation of its Active Directory attack testing features.

## Licensing

This software is provided under a slightly modified version of the Apache Software License. See the accompanying¬†[LICENSE](https://github.com/fortra/impacket/blob/master/LICENSE)¬†file for more information.

SMBv1 and NetBIOS support based on Pysmb by Michael Teo.

## Contact Us

If you want to report a bug, send a patch or give some suggestions on this package, fill out our¬†[contact form](https://www.coresecurity.com/about/contact).

**Credit:**¬†This information was adapted from an excellent guide on¬†[CoreSecurity](https://www.coresecurity.com/core-labs/open-source-tools/impacket). Be sure to check out the original post for more details.

<iframe width="560" height="315" src="https://www.youtube.com/embed/C7ehSEzlwCk?si=Pty3rh4MBEup5GwH" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>

**Credit:**¬†This information was adapted from an excellent guide on¬†[YouTube](https://www.youtube.com/watch?v=C7ehSEzlwCk). Be sure to check out the original post for more details.

**N.B.:** @SathvikTechtuber has other notable tools to utilize during the OSCP at [YouTube](https://www.youtube.com/@SathvikTechtuber)

<iframe width="560" height="315" src="https://www.youtube.com/embed/AU21cLf5WFk?si=6NWOQfa9CqlnBaQX" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>

**Credit:**¬†This information was adapted from an excellent guide on¬†[YouTube](https://www.youtube.com/watch?v=AU21cLf5WFk&t=350s). Be sure to check out the original post for more details.

<iframe width="560" height="315" src="https://www.youtube.com/embed/UMogme3rDRA?si=qUQk5VvqcowJ7Dyq" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>

**Credit:**¬†This information was adapted from an excellent guide on¬†[YouTube](https://www.youtube.com/watch?v=UMogme3rDRA). Be sure to check out the original post for more details.
