Let me preface this by acknowledging that these two programs are not the same software, although they are listed together in this folder. They serve similar purposes in the context of penetration testing and password cracking though. Both tools are used for brute-force attacks, but they have different features and implementations. The key differences are as follows:

- **Hydra**: Hydra is a very popular password cracking tool that supports a wide range of protocols, including HTTP, FTP, SMTP, SSH, and more. It is known for its speed and efficiency in conducting brute-force attacks on login credentials.
    
- **Medusa**: Medusa is another password brute-forcing tool, similar to Hydra, but it has a different set of supported protocols and features. Medusa is designed to be fast and flexible, supporting parallel brute-force attacks across multiple hosts.

Hydra and Medusa are used for network-based brute-forcing and aim to crack passwords. This should not be confused with John the Ripper which is primarily used for offline password cracking. For this reason, I have listed these two password cracking programs together.

  H Y D R A

                      (c) 2001-2023 by van Hauser / THC
             <vh@thc.org> [https://github.com/vanhauser-thc/thc-hydra](https://github.com/vanhauser-thc/thc-hydra)
       many modules were written by David (dot) Maciejak @ gmail (dot) com
                 BFG code by Jan Dlabal <dlabaljan@gmail.com>

  		    Licensed under AGPLv3 (see LICENSE file)

           Please do not use in military or secret service organizations,
                          or for illegal purposes.
      (This is the wish of the author and non-binding. Many people working
       in these organizations do not care for laws and ethics anyways.
            You are not one of the "good" ones if you ignore this.)

           NOTE: no this is not meant to be a markdown doc! old school!


Hydra in the most current github state can be directly downloaded via docker:
```
docker pull vanhauser/hydra
```


INTRODUCTION
------------
Number one of the biggest security holes are passwords, as every password
security study shows.
This tool is a proof of concept code, to give researchers and security
consultants the possibility to show how easy it would be to gain unauthorized
access from remote to a system.

THIS TOOL IS FOR LEGAL PURPOSES ONLY!

There are already several login hacker tools available, however, none does
either support more than one protocol to attack or support parallelized
connects.

It was tested to compile cleanly on Linux, Windows/Cygwin, Solaris,
FreeBSD/OpenBSD, QNX (Blackberry 10) and MacOS.

Currently this tool supports the following protocols:
 Asterisk, AFP, Cisco AAA, Cisco auth, Cisco enable, CVS, Firebird, FTP,
 HTTP-FORM-GET, HTTP-FORM-POST, HTTP-GET, HTTP-HEAD, HTTP-POST, HTTP-PROXY,
 HTTPS-FORM-GET, HTTPS-FORM-POST, HTTPS-GET, HTTPS-HEAD, HTTPS-POST,
 HTTP-Proxy, ICQ, IMAP, IRC, LDAP, MEMCACHED, MONGODB, MS-SQL, MYSQL, NCP, NNTP, Oracle Listener,
 Oracle SID, Oracle, PC-Anywhere, PCNFS, POP3, POSTGRES, Radmin, RDP, Rexec, Rlogin,
 Rsh, RTSP, SAP/R3, SIP, SMB, SMTP, SMTP Enum, SNMP v1+v2+v3, SOCKS5,
 SSH (v1 and v2), SSHKEY, Subversion, Teamspeak (TS2), Telnet, VMware-Auth,
 VNC and XMPP.

However the module engine for new services is very easy so it won't take a
long time until even more services are supported.
Your help in writing, enhancing or fixing modules is highly appreciated!! :-)



WHERE TO GET
------------
You can always find the newest release/production version of hydra at its
project page at [https://github.com/vanhauser-thc/thc-hydra/releases](https://github.com/vanhauser-thc/thc-hydra/releases)
If you are interested in the current development state, the public development
repository is at Github:
  svn co [https://github.com/vanhauser-thc/thc-hydra](https://github.com/vanhauser-thc/thc-hydra)
 or
  git clone [https://github.com/vanhauser-thc/thc-hydra](https://github.com/vanhauser-thc/thc-hydra)
Use the development version at your own risk. It contains new features and
new bugs. Things might not work!

Alternatively (and easier) to can pull it as a docker container:
```
docker pull vanhauser/hydra
```


HOW TO COMPILE
--------------
To configure, compile and install hydra, just type:

```
./configure
make
make install
```

If you want the ssh module, you have to setup libssh (not libssh2!) on your
system,  get it from [https://www.libssh.org](https://www.libssh.org/), for ssh v1 support you also need
to add "-DWITH_SSH1=On" option in the cmake command line.
IMPORTANT: If you compile on MacOS then you must do this - do not install libssh via brew!

If you use Ubuntu/Debian, this will install supplementary libraries needed
for a few optional modules (note that some might not be available on your distribution):

```
apt-get install libssl-dev libssh-dev libidn11-dev libpcre3-dev \
                 libgtk2.0-dev libmysqlclient-dev libpq-dev libsvn-dev \
                 firebird-dev libmemcached-dev libgpg-error-dev \
                 libgcrypt11-dev libgcrypt20-dev
```

This enables all optional modules and features with the exception of Oracle,
SAP R/3, NCP and the apple filing protocol - which you will need to download and
install from the vendor's web sites.

For all other Linux derivates and BSD based systems, use the system
software installer and look for similarly named libraries like in the
command above. In all other cases, you have to download all source libraries
and compile them manually.



SUPPORTED PLATFORMS
-------------------
- All UNIX platforms (Linux, *BSD, Solaris, etc.)
- MacOS (basically a BSD clone)
- Windows with Cygwin (both IPv4 and IPv6)
- Mobile systems based on Linux, MacOS or QNX (e.g. Android, iPhone, Blackberry 10, Zaurus, iPaq)



HOW TO USE
----------
If you just enter `hydra`, you will see a short summary of the important
options available.
Type `./hydra -h` to see all available command line options.

Note that NO login/password file is included. Generate them yourself.
A default password list is however present, use "dpl4hydra.sh" to generate
a list.

For Linux users, a GTK GUI is available, try `./xhydra`

For the command line usage, the syntax is as follows:
 For attacking one target or a network, you can use the new "://" style:
  hydra [some command line options] PROTOCOL://TARGET:PORT/MODULE-OPTIONS
 The old mode can be used for these too, and additionally if you want to
 specify your targets from a text file, you *must* use this one:

```
hydra [some command line options] [-s PORT] TARGET PROTOCOL [MODULE-OPTIONS]
```

Via the command line options you specify which logins to try, which passwords,
if SSL should be used, how many parallel tasks to use for attacking, etc.

PROTOCOL is the protocol you want to use for attacking, e.g. ftp, smtp,
http-get or many others are available
TARGET is the target you want to attack
MODULE-OPTIONS are optional values which are special per PROTOCOL module

FIRST - select your target
 you have three options on how to specify the target you want to attack:
 1. a single target on the command line: just put the IP or DNS address in
 2. a network range on the command line: CIDR specification like "192.168.0.0/24"
 3. a list of hosts in a text file: one line per entry (see below)

SECOND - select your protocol
 Try to avoid telnet, as it is unreliable to detect a correct or false login attempt.
 Use a port scanner to see which protocols are enabled on the target.

THIRD - check if the module has optional parameters
 hydra -U PROTOCOL
 e.g. hydra -U smtp

FOURTH - the destination port
 this is optional, if no port is supplied the default common port for the
 PROTOCOL is used.
 If you specify SSL to use ("-S" option), the SSL common port is used by default.


If you use "://" notation, you must use "[" "]" brackets if you want to supply
IPv6 addresses or CIDR ("192.168.0.0/24") notations to attack:
  hydra [some command line options] ftp://[192.168.0.0/24]/
  hydra [some command line options] -6 smtps://[2001:db8::1]/NTLM

Note that everything hydra does is IPv4 only!
If you want to attack IPv6 addresses, you must add the "-6" command line option.
All attacks are then IPv6 only!

If you want to supply your targets via a text file, you can not use the ://
notation but use the old style and just supply the protocol (and module options):
  hydra [some command line options] -M targets.txt ftp
You can also supply the port for each target entry by adding ":<port>" after a
target entry in the file, e.g.:

```
foo.bar.com
target.com:21
unusual.port.com:2121
default.used.here.com
127.0.0.1
127.0.0.1:2121
```

Note that if you want to attach IPv6 targets, you must supply the -6 option
and *must* put IPv6 addresses in brackets in the file(!) like this:

```
foo.bar.com
target.com:21
[fe80::1%eth0]
[2001::1]
[2002::2]:8080
[2a01:24a:133:0:00:123:ff:1a]
```

LOGINS AND PASSWORDS
--------------------
You have many options on how to attack with logins and passwords
With -l for login and -p for password you tell hydra that this is the only
login and/or password to try.
With -L for logins and -P for passwords you supply text files with entries.
e.g.:

```
hydra -l admin -p password ftp://localhost/
hydra -L default_logins.txt -p test ftp://localhost/
hydra -l admin -P common_passwords.txt ftp://localhost/
hydra -L logins.txt -P passwords.txt ftp://localhost/
```

Additionally, you can try passwords based on the login via the "-e" option.
The "-e" option has three parameters:

```
s - try the login as password
n - try an empty password
r - reverse the login and try it as password
```

If you want to, e.g. try "try login as password and "empty password", you 
specify "-e sn" on the command line.

But there are two more modes for trying passwords than -p/-P:
You can use text file which where a login and password pair is separated by a colon,
e.g.:

```
admin:password
test:test
foo:bar
```

This is a common default account style listing, that is also generated by the
dpl4hydra.sh default account file generator supplied with hydra.
You use such a text file with the -C option - note that in this mode you
can not use -l/-L/-p/-P options (-e nsr however you can).
Example:

```
hydra -C default_accounts.txt ftp://localhost/
```

And finally, there is a bruteforce mode with the -x option (which you can not
use with -p/-P/-C):

```
-x minimum_length:maximum_length:charset
```

the charset definition is `a` for lowercase letters, `A` for uppercase letters,
`1` for numbers and for anything else you supply it is their real representation.
Examples:

```
-x 1:3:a generate passwords from length 1 to 3 with all lowercase letters
-x 2:5:/ generate passwords from length 2 to 5 containing only slashes
-x 5:8:A1 generate passwords from length 5 to 8 with uppercase and numbers
-x '3:3:aA1&~#\\ "\'<{([-|_^@)]=}>$%*?./§,;:!`' -v generates lenght 3 passwords with all 95 characters, and verbose. 
```

Example:

```
hydra -l ftp -x 3:3:a ftp://localhost/
```

SPECIAL OPTIONS FOR MODULES
---------------------------
Via the third command line parameter (TARGET SERVICE OPTIONAL) or the -m
command line option, you can pass one option to a module.
Many modules use this, a few require it!

To see the special option of a module, type:

  hydra -U <module>

e.g.

  ./hydra -U http-post-form

The special options can be passed via the -m parameter, as 3rd command line
option or in the service://target/option format.

Examples (they are all equal):

```
./hydra -l test -p test -m PLAIN 127.0.0.1 imap
./hydra -l test -p test 127.0.0.1 imap PLAIN
./hydra -l test -p test imap://127.0.0.1/PLAIN
```

RESTORING AN ABORTED/CRASHED SESSION
------------------------------------
When hydra is aborted with Control-C, killed or crashes, it leaves a
"hydra.restore" file behind which contains all necessary information to
restore the session. This session file is written every 5 minutes.
NOTE: the hydra.restore file can NOT be copied to a different platform (e.g.
from little endian to big endian, or from Solaris to AIX)

HOW TO SCAN/CRACK OVER A PROXY
------------------------------
The environment variable HYDRA_PROXY_HTTP defines the web proxy (this works
just for the http services!).
The following syntax is valid:

```
HYDRA_PROXY_HTTP="[http://123.45.67.89:8080/](http://123.45.67.89:8080/)"
HYDRA_PROXY_HTTP="http://login:password@123.45.67.89:8080/"
HYDRA_PROXY_HTTP="proxylist.txt"
```

The last example is a text file containing up to 64 proxies (in the same
format definition as the other examples).

For all other services, use the HYDRA_PROXY variable to scan/crack.
It uses the same syntax. eg:

```
HYDRA_PROXY=[connect|socks4|socks5]://[login:password@]proxy_addr:proxy_port
```

for example:

```
HYDRA_PROXY=connect://proxy.anonymizer.com:8000
HYDRA_PROXY=socks4://auth:pw@127.0.0.1:1080
HYDRA_PROXY=socksproxylist.txt
```

ADDITIONAL HINTS
----------------
* sort your password files by likelihood and use the -u option to find
  passwords much faster!
* uniq your dictionary files! this can save you a lot of time :-)
    cat words.txt | sort | uniq > dictionary.txt
* if you know that the target is using a password policy (allowing users
  only to choose a password with a minimum length of 6, containing a least one
  letter and one number, etc. use the tool pw-inspector which comes along
  with the hydra package to reduce the password list:
    cat dictionary.txt | pw-inspector -m 6 -c 2 -n > passlist.txt


RESULTS OUTPUT
--------------

The results are output to stdio along with the other information.  Via the -o
command line option, the results can also be written to a file.  Using -b,
the format of the output can be specified.  Currently, these are supported:

* `text`   - plain text format
* `jsonv1` - JSON data using version 1.x of the schema (defined below).
* `json`   - JSON data using the latest version of the schema, currently there
             is only version 1.

If using JSON output, the results file may not be valid JSON if there are
serious errors in booting Hydra.


JSON Schema
-----------
Here is an example of the JSON output.  Notes on some of the fields:

* `errormessages` - an array of zero or more strings that are normally printed
   to stderr at the end of the Hydra's run.  The text is very free form.
* `success` - indication if Hydra ran correctly without error (**NOT** if
   passwords were detected).  This parameter is either the JSON value `true`
   or `false` depending on completion.  
* `quantityfound` - How many username+password combinations discovered.
* `jsonoutputversion` - Version of the schema, 1.00, 1.01, 1.11, 2.00,
   2.03, etc.  Hydra will make second tuple of the version to always be two
   digits to make it easier for downstream processors (as opposed to v1.1 vs
   v1.10).  The minor-level versions are additive, so 1.02 will contain more
   fields than version 1.00 and will be backward compatible.  Version 2.x will
   break something from version 1.x output.  

Version 1.00 example:
```
{
    "errormessages": [
        "[ERROR] Error Message of Something",
        "[ERROR] Another Message",
        "These are very free form"
    ],
    "generator": {
        "built": "2021-03-01 14:44:22",
        "commandline": "hydra -b jsonv1 -o results.json ... ...",
        "jsonoutputversion": "1.00",
        "server": "127.0.0.1",
        "service": "http-post-form",
        "software": "Hydra",
        "version": "v8.5"
    },
    "quantityfound": 2,
    "results": [
        {
            "host": "127.0.0.1",
            "login": "bill@example.com",
            "password": "bill",
            "port": 9999,
            "service": "http-post-form"
        },
        {
            "host": "127.0.0.1",
            "login": "joe@example.com",
            "password": "joe",
            "port": 9999,
            "service": "http-post-form"
        }
    ],
    "success": false
}
```


SPEED
-----
through the parallelizing feature, this password cracker tool can be very
fast, however it depends on the protocol. The fastest are generally POP3
and FTP.
Experiment with the task option (-t) to speed things up! The higher - the
faster ;-) (but too high - and it disables the service)



STATISTICS
----------
Run against a SuSE Linux 7.2 on localhost with a "-C FILE" containing
295 entries (294 tries invalid logins, 1 valid). Every test was run three
times (only for "1 task" just once), and the average noted down.

```
			P A R A L L E L    T A S K S
SERVICE	1	4	8	16	32	50	64	100	128
------- --------------------------------------------------------------------
telnet	23:20	5:58	2:58	1:34	1:05	0:33	0:45*	0:25*	0:55*
ftp	45:54	11:51	5:54	3:06	1:25	0:58	0:46	0:29	0:32
pop3	92:10	27:16	13:56	6:42	2:55	1:57	1:24	1:14	0:50
imap	31:05	7:41	3:51	1:58	1:01	0:39	0:32	0:25	0:21
```

(*)
Note: telnet timings can be VERY different for 64 to 128 tasks! e.g. with
128 tasks, running four times resulted in timings between 28 and 97 seconds!
The reason for this is unknown...

guesses per task (rounded up):
	
  295	74	38	19	10	6	5	3	3

guesses possible per connect (depends on the server software and config):
	
  telnet	4
	ftp	6
	pop3	1
	imap	3



BUGS & FEATURES
---------------
Hydra:
Email me or David if you find bugs or if you have written a new module.
vh@thc.org (and put "antispam" in the subject line)


You should use PGP to encrypt emails to vh@thc.org :

```
-----BEGIN PGP PUBLIC KEY BLOCK-----
Version: GnuPG v3.3.3 (vh@thc.org)

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
zB3yrr+vYBT0uDWmxwPjiJs=
=ytEf
-----END PGP PUBLIC KEY BLOCK-----
```

**Credit:** This information was adapted from an excellent guide on [GitHub](https://github.com/vanhauser-thc/thc-hydra). Be sure to check out the original post for more details.

# TryHackMe Hydra Walkthrough

# Hydra Introduction:

> What is Hydra?

Hydra is a brute force online password cracking program, a quick system login password “hacking” tool.

Hydra can run through a list and “brute force” some authentication services. Imagine trying to manually guess someone’s password on a particular service (SSH, Web Application Form, FTP or SNMP) — we can use Hydra to run through a password list and speed this process up for us, determining the correct password.

According to its [official repository](https://github.com/vanhauser-thc/thc-hydra), Hydra supports, i.e., has the ability to brute force the following protocols: “Asterisk, AFP, Cisco AAA, Cisco auth, Cisco enable, CVS, Firebird, FTP, HTTP-FORM-GET, HTTP-FORM-POST, HTTP-GET, HTTP-HEAD, HTTP-POST, HTTP-PROXY, HTTPS-FORM-GET, HTTPS-FORM-POST, HTTPS-GET, HTTPS-HEAD, HTTPS-POST, HTTP-Proxy, ICQ, IMAP, IRC, LDAP, MEMCACHED, MONGODB, MS-SQL, MYSQL, NCP, NNTP, Oracle Listener, Oracle SID, Oracle, PC-Anywhere, PCNFS, POP3, POSTGRES, Radmin, RDP, Rexec, Rlogin, Rsh, RTSP, SAP/R3, SIP, SMB, SMTP, SMTP Enum, SNMP v1+v2+v3, SOCKS5, SSH (v1 and v2), SSHKEY, Subversion, TeamSpeak (TS2), Telnet, VMware-Auth, VNC and XMPP.”

For more information on the options of each protocol in Hydra, you can check the [Kali Hydra tool page](https://en.kali.tools/?p=220).

This shows the importance of using a strong password; if your password is common, doesn’t contain special characters and is not above eight characters, it will be prone to be guessed. A one-hundred-million-password list contains common passwords, so when an out-of-the-box application uses an easy password to log in, change it from the default! CCTV cameras and web frameworks often use `admin:password` as the default login credentials, which is obviously not strong enough.

> Installing Hydra

If you prefer to use the in-browser Kali machine, Hydra also comes pre-installed, as is the case with all Kali distributions. You can access it by selecting Use Kali Linux and clicking on **Start Kali Linux** button.

However, you can check its official repositories if you prefer to use another Linux distribution. For instance, you can install Hydra on an Ubuntu or Fedora system by executing `apt install hydra` or `dnf install hydra`. Furthermore, you can download it from its official [THC-Hydra repository](https://github.com/vanhauser-thc/thc-hydra).

# Using Hydra:

> Hydra Commands

The options we pass into Hydra depend on which service (protocol) we’re attacking. For example, if we wanted to brute force FTP with the username being `user` and a password list being `passlist.txt`, we’d use the following command:

`hydra -l user -P passlist.txt ftp://MACHINE_IP`

For this deployed machine, here are the commands to use Hydra on SSH and a web form (POST method).

> SSH

`hydra -l <username> -P <full path to pass> MACHINE_IP -t 4 ssh`

Option Description `-l` specifies the (SSH) username for login `-P` indicates a list of passwords `-t` sets the number of threads to spawn

For example, `hydra -l root -P passwords.txt MACHINE_IP -t 4 ssh` will run with the following arguments:

- Hydra will use `root` as the username for `ssh`
- It will try the passwords in the `passwords.txt` file
- There will be four threads running in parallel as indicated by `-t 4`

> Post Web Form

We can use Hydra to brute force web forms too. You must know which type of request it is making; GET or POST methods are commonly used. You can use your browser’s network tab (in developer tools) to see the request types or view the source code.

`sudo hydra <username> <wordlist> MACHINE_IP http-post-form "<path>:<login_credentials>:<invalid_response>"`

Option Description `-l` the username for (web form) login `-P` the password list to use `http-post-form` the type of the form is POST `<path>` the login page URL, for example, `login.php` `<login_credentials>` the username and password used to log in, for example, `username=^USER^&password=^PASS^` `<invalid_response>` part of the response when the login fails `-V` verbose output for every attempt

Below is a more concrete example Hydra command to brute force a POST login form:

`hydra -l <username> -P <wordlist> MACHINE_IP http-post-form "/:username=^USER^&password=^PASS^:F=incorrect" -V`

- The login page is only `/`, i.e., the main IP address.
- The `username` is the form field where the username is entered
- The specified username(s) will replace `^USER^`
- The `password` is the form field where the password is entered
- The provided passwords will be replacing `^PASS^`
- Finally, `F=incorrect` is a string that appears in the server reply when the login fails

First of all, we have scanned the IP address with Nmap, and then we have found that SSH and HTTP web pages are running. So let’s fire up the browser, type the machine’s IP, and we have discovered a login page. Let’s brute force it.

![](https://miro.medium.com/v2/resize:fit:700/1*LucioH7P0hN0NC1C-q_gfw.png)

![](https://miro.medium.com/v2/resize:fit:700/1*mIiOUlUEL1WRhpm43b72Vw.png)

![](https://miro.medium.com/v2/resize:fit:700/1*vyNsNlmHOZ9C5Eg2DtXnew.png)

1. **What is flag 1?**

Ans:- THM{2673a7dd116de68e85c48ec0b1f2612e}

![](https://miro.medium.com/v2/resize:fit:700/1*cOJlusAftQrkK43xCp_P2Q.png)

![](https://miro.medium.com/v2/resize:fit:700/1*B2H22Pnb3Ro8CsL4pBnGxQ.png)

![](https://miro.medium.com/v2/resize:fit:301/1*5TlkCHN7gTAi4qixEwiPig.png)

**2. What is Flag2**

**Ans**:- THM{c8eeb0468febbadea859baeb33b2541b}

**Credit:** This information was adapted from an excellent guide on [Medium](https://medium.com/@akashfalaskar/tryhackme-hydra-walkthrough-98ab1b7665bc). Be sure to check out the original post for more details.

# Medusa Parallel Network Login Auditor

_JoMo-Kun / jmk "AT" foofus "DOT" net_  

---

- [What?](https://jmk-foofus.github.io/medusa/medusa.html#what)
- [Why?](https://jmk-foofus.github.io/medusa/medusa.html#why)
- [How?](https://jmk-foofus.github.io/medusa/medusa.html#how)
- [Where?](https://jmk-foofus.github.io/medusa/medusa.html#where)
- [Who?](https://jmk-foofus.github.io/medusa/medusa.html#who)
- [Huh?](https://jmk-foofus.github.io/medusa/medusa.html#huh)

## What?

Medusa is intended to be a speedy, massively parallel, modular, login brute-forcer. The goal is to support as many services which allow remote authentication as possible. The author considers following items as some of the key features of this application:

- **Thread-based parallel testing.** Brute-force testing can be performed against multiple hosts, users or passwords concurrently.
- **Flexible user input.** Target information (host/user/password) can be specified in a variety of ways. For example, each item can be either a single entry or a file containing multiple entries. Additionally, a combination file format allows the user to refine their target listing.
- **Modular design.** Each service module exists as an independent .mod file. This means that no modifications are necessary to the core application in order to extend the supported list of services for brute-forcing.

## Why?

Why create Medusa? Isn't this the same thing as [THC-Hydra](https://github.com/vanhauser-thc/thc-hydra)? Here are some of the reasons for this application:

- **Application stability.** Maybe I'm just lame, but Hydra frequently crashed on me. I was no longer confident that Hydra was actually doing what it claimed to be. Rather than fix Hydra, I decided to create my own buggy application which could crash in new and exciting ways.
- **Code organization.** A while back I added several features to Hydra (parallel host scanning, SMBNT module). Retro-fitting the parallel host code to Hydra was a serious pain. This was mainly due to my coding ignorance, but was probably also due to Hydra not being designed from the ground-up to support this. Medusa was designed from the start to support parallel testing of hosts, users and passwords.
- **Speed.** Hydra accomplishes its parallel testing by forking off a new process for each host and instance of the service being tested. When testing many hosts/users at once this creates a large amount of overhead as user/password lists must be duplicated for each forked process. Medusa is pthread-based and does not unnecessarily duplicate information.
- **Education.** I am not an experienced C programmer, nor do I consider myself an expert in multi-threaded programming. Writing this application was a training exercise for me. Hopefully, the results of it will be useful for others.

  
For a quick comparison of Medusa, Ncrack, and THC-Hydra see: [medusa-compare.html](https://jmk-foofus.github.io/medusa/medusa-compare.html)  

## How?

How do I use this thing? Simply running "medusa" without any options will dump all the parameters it accepts along with their respective description. Here are several example uses:

- _Display all modules currently installed:_  
    `% medusa -d   Medusa v1.0-rc1 [http://www.foofus.net] (C) JoMo-Kun / Foofus Networks    Available modules in "." :   Available modules in "/usr/local/lib/medusa/modules" :     + mssql.mod :       Brute force module for M$-SQL sessions : version 0.1.0     + http.mod :       Brute force module for HTTP : version 0.1.1     + ssh.mod :       Brute force module for SSH v2 sessions : version 0.1.1     + smbnt.mod :       Brute force module for SMB/NTLMv1 sessions : version 0.1.1     + telnet.mod :       Brute force module for telnet sessions : version 0.1.4`
    
- _Display specific options for a given module:_  
    `% medusa -M smbnt -q  Medusa v1.0-rc1 [http://www.foofus.net] (C) JoMo-Kun / Foofus Networks  smbnt.mod (0.1.1) JoMo-Kun :: Brute force module for SMB/NTLMv1 sessions  Available module options:   GROUP:? (DOMAIN, LOCAL*, BOTH)     Option sets NetBIOS workgroup field.     DOMAIN: Check credentials against this hosts primary domain controller via this host.     LOCAL:  Check local account.     BOTH:   Check both. This leaves the workgroup field set blank and then attempts to check             the credentials against the host. If the account does not exist locally on the             host being tested, that host then queries its domain controller.   GROUP_OTHER:?     Option allows manual setting of domain to check against. Use instead of GROUP.   PASS:?  (PASSWORD*, HASH, MACHINE)     PASSWORD: Use normal password.     HASH:     Use a NTLM hash rather than a password.     MACHINE:  Use the machine's NetBIOS name as the password.   NETBIOS     Force NetBIOS Mode (Disable Native Win2000 Mode). Win2000 mode is the default.     Default mode is to test TCP/445 using Native Win2000. If this fails, module will     fall back to TCP/139 using NetBIOS mode. To test only TCP/139, use the following:     medusa -M smbnt -m NETBIOS -n 139  (*) Default value Usage example: "-M smbnt -m GROUP:DOMAIN -m PASS:HASH"`
    
- _The following command instructs Medusa to test all passwords listed in passwords.txt against a single user (administrator) on the host 192.168.0.20 via the SMB service. The "-e ns" instructs Medusa to additionally check if the administrator account has either a blank password or has its password set to match its username (administrator)._  
    
    ```
    
    % medusa -h 192.168.0.20 -u administrator -P passwords.txt -e ns -M smbnt
    
    Medusa v1.0-rc1 [http://www.foofus.net] (C) JoMo-Kun / Foofus Networks
    
    ACCOUNT CHECK: [smbnt] Host: 192.168.0.20 (1/1) User: administrator (1/1) Password:  (1/7)
    ACCOUNT CHECK: [smbnt] Host: 192.168.0.20 (1/1) User: administrator (1/1) Password: administrator (2/7)
    ACCOUNT CHECK: [smbnt] Host: 192.168.0.20 (1/1) User: administrator (1/1) Password: password (3/7)
    ACCOUNT CHECK: [smbnt] Host: 192.168.0.20 (1/1) User: administrator (1/1) Password: pass1 (4/7)
    ACCOUNT CHECK: [smbnt] Host: 192.168.0.20 (1/1) User: administrator (1/1) Password: pass2 (5/7)
    ACCOUNT CHECK: [smbnt] Host: 192.168.0.20 (1/1) User: administrator (1/1) Password: pass3 (6/7)
    ACCOUNT CHECK: [smbnt] Host: 192.168.0.20 (1/1) User: administrator (1/1) Password: pass4 (7/7)
    ```
    
- _The below command-line demonstrates how to execute some of the parallel features of Medusa. Here at least 20 hosts and 10 users are tested concurrently. The "-L" options instructs Medusa to parallelize by user. This means each of the 10 threads targeting a host checks a unique user._  
    
    ```
    
    % medusa -H hosts.txt -U users.txt -P passwords.txt -T 20 -t 10 -L -F -M smbnt
    ```
    
- _Medusa allows host/username/password data to also be set using a "combo" file. The combo file can be specified using the "-C" option. The file should contain one entry per line and have the values colon separated in the format host:user:password. If any of the three fields are left empty, the respective information should be provided either as a global value or as a list in a file. Medusa will perform a basic parameter check based on the contents of the first line in the file._
    
    _The following combinations are possible in the combo file:_
    
    - host:username:password
    - host:username:
    - host::
    - :username:password
    - :username:
    - ::password
    - host::password
    
    _The following example will check each entry in the file combo.txt_  
    `% medusa -M smbnt -C combo.txt   `  
    _The combo.txt file:_  
    `192.168.0.20:administrator:password   192.168.0.20:testuser:pass   192.168.0.30:administrator:blah   192.168.0.40:user1:foopass   `
    
    _The following example will check each entry in the file combo.txt against the targets listed in hosts.txt_  
    `% medusa -M smbnt -C combo.txt -H hosts.txt   `  
    _The combo.txt file:_  
    `:administrator:password   :testuser:pass   :administrator:blah   :user1:foopass   `
    
    _Medusa also supports using PwDump files as a combo file. The format of these files should be user:id:lm:ntlm:::. We look for ':::' at the end of the first line to determine if the file contains PwDump output._
    
- _Resume a Medusa scan. Medusa has the ability to resume a scan which was interrupted with a SIGINT signal (e.g. CTRL-C). For example:_
    
    _Test interrupted with SIGINT_  
    `% ../medusa -M ssh -H host.txt -U users.txt -p password   Medusa v2.0 [http://www.foofus.net] (C) JoMo-Kun / Foofus Networks      ACCOUNT CHECK: [ssh] Host: 192.168.0.1 (1 of 11, 0 complete) User: foo (1 of 4, 0 complete) Password: password (1 of 1 complete)   ACCOUNT CHECK: [ssh] Host: 192.168.0.1 (1 of 11, 0 complete) User: administrator (2 of 4, 1 complete) Password: password (1 of 1 complete)   ACCOUNT CHECK: [ssh] Host: 192.168.0.1 (1 of 11, 0 complete) User: jmk (3 of 4, 2 complete) Password: password (1 of 1 complete)   ACCOUNT CHECK: [ssh] Host: 192.168.0.1 (1 of 11, 0 complete) User: bar (4 of 4, 3 complete) Password: password (1 of 1 complete)   ACCOUNT CHECK: [ssh] Host: 192.168.0.11 (2 of 11, 1 complete) User: foo (1 of 4, 0 complete) Password: password (1 of 1 complete)   ACCOUNT CHECK: [ssh] Host: 192.168.0.11 (2 of 11, 1 complete) User: administrator (2 of 4, 1 complete) Password: password (1 of 1 complete)   ALERT: Medusa received SIGINT - Sending notification to login threads that we are are aborting.   ACCOUNT CHECK: [ssh] Host: 192.168.0.11 (2 of 11, 1 complete) User: jmk (3 of 4, 2 complete) Password: password (1 of 1 complete)   ALERT: To resume scan, add the following to your original command: "-Z h2u3u4h3."   `
    
    _Interrupted scan being resumed_  
    `% ../medusa -M ssh -H host.txt -U users.txt -p password -Z h2u3u4h3.   Medusa v2.0 [http://www.foofus.net] (C) JoMo-Kun / Foofus Networks      ACCOUNT CHECK: [ssh] Host: 192.168.0.11 (2 of 11, 0 complete) User: jmk (3 of 4, 0 complete) Password: password (1 of 1 complete)   ACCOUNT CHECK: [ssh] Host: 192.168.0.11 (2 of 11, 0 complete) User: bar (4 of 4, 1 complete) Password: password (1 of 1 complete)   ACCOUNT CHECK: [ssh] Host: 192.168.0.15 (3 of 11, 1 complete) User: foo (1 of 4, 0 complete) Password: password (1 of 1 complete)   `
    
    _The following is a brief discription of the resume map:_  
    
    h2u3u4h3.
    +--------- First host which was not 100% completed
      +------- First user for host which was not 100% completed
        +----- First user for host which was not started
          +--- First host which was not started
            +- Map ending mark
    

### Module specific details:

- [AFP](https://jmk-foofus.github.io/medusa/medusa-afp.html)
- [CVS](https://jmk-foofus.github.io/medusa/medusa-cvs.html)
- [FTP](https://jmk-foofus.github.io/medusa/medusa-ftp.html)
- [HTTP](https://jmk-foofus.github.io/medusa/medusa-http.html)
- [IMAP](https://jmk-foofus.github.io/medusa/medusa-imap.html)
- [MS-SQL](https://jmk-foofus.github.io/medusa/medusa-mssql.html)
- [MySQL](https://jmk-foofus.github.io/medusa/medusa-mysql.html)
- [NetWare NCP](https://jmk-foofus.github.io/medusa/medusa-ncp.html)
- [NNTP](https://jmk-foofus.github.io/medusa/medusa-nntp.html)
- [PcAnywhere](https://jmk-foofus.github.io/medusa/medusa-pcanywhere.html)
- [POP3](https://jmk-foofus.github.io/medusa/medusa-pop3.html)
- [PostgreSQL](https://jmk-foofus.github.io/medusa/medusa-postgres.html)
- [REXEC](https://jmk-foofus.github.io/medusa/medusa-rexec.html)
- [RDP](https://jmk-foofus.github.io/medusa/medusa-rdp.html)
- [RLOGIN](https://jmk-foofus.github.io/medusa/medusa-rlogin.html)
- [RSH](https://jmk-foofus.github.io/medusa/medusa-rsh.html)
- [SMBNT (SMBv1-3, SMB signing)](https://jmk-foofus.github.io/medusa/medusa-smbnt.html)
- [SMTP-AUTH](https://jmk-foofus.github.io/medusa/medusa-smtp.html)
- [SMTP-VRFY](https://jmk-foofus.github.io/medusa/medusa-smtp-vrfy.html)
- [SNMP](https://jmk-foofus.github.io/medusa/medusa-snmp.html)
- [SSHv2](https://jmk-foofus.github.io/medusa/medusa-ssh.html)
- [Subversion (SVN)](https://jmk-foofus.github.io/medusa/medusa-svn.html)
- [Telnet](https://jmk-foofus.github.io/medusa/medusa-telnet.html)
- [VMware Authentication Daemon (vmauthd)](https://jmk-foofus.github.io/medusa/medusa-vmauthd.html)
- [VNC](https://jmk-foofus.github.io/medusa/medusa-vnc.html)
- [Generic Wrapper](https://jmk-foofus.github.io/medusa/medusa-wrapper.html)
- [Web Form](https://jmk-foofus.github.io/medusa/medusa-web-form.html)

## Where?

[GitHub](https://github.com/jmk-foofus/medusa)  
[Medusa-gui](https://github.com/Tak31337/medusa-gui) (Java-based GUI developed by tak and bigmoneyhat)  

### Install Instructions:

#### General

The majority of Medusa was written and tested on Linux/Gentoo-based systems. While it has been known to work on variety of operating systems, it is quite possible there may be issues that crop up only on non-Gentoo devices. Of course, there are issues that will probably also show up on Gentoo that have so far been missed...

Medusa should be fairly straight-forward to build: "./configure; make; make install". However, this may result in a somewhat limited installation. To take full advantage of all the brute-forcing goodness that Medusa has to offer, several dependencies must be satisfied. The following table lists out the modules which have additional dependencies. In order for the modules to function, the appropriate header files must be installed on the system when the modules themselves are compiled. Additional module specific information is included within the documentation for each module.  
  

|   |   |   |   |
|---|---|---|---|
|**Dependency**|**Homepage**|**Module**|**Notes**|
|OpenSSL|[http://www.openssl.org](http://www.openssl.org/)|HTTP, MSSQL, SMBNT, SSL-based connections||
|LibSMB2|[https://github.com/sahlberg/libsmb2](https://github.com/sahlberg/libsmb2)|SMBNT (SMBv2 Support)|SMBNT module natively supports SMBv1. If libsmb2 is present, it also supports SMBv2/3 and SMB signing.|
|LibSSH2|[http://www.libssh2.org](http://www.libssh2.org/)|SSH|LibSSH2 patch provided to address timing issue. Issue appears to be addressed in 0.18.|
|NCPFS|[ftp://platan.vc.cvut.cz/pub/linux/ncpfs](ftp://platan.vc.cvut.cz/pub/linux/ncpfs/)|NCP|Use "make install-dev" to install header files.|
|LibPQ|[http://www.postgresql.org](http://www.postgresql.org/)|PostgreSQL||
|Subversion|[http://subversion.tigris.org](http://subversion.tigris.org/)|SVN||
|afpfs-ng|[http://alexthepuffin.googlepages.com/home](http://alexthepuffin.googlepages.com/home)|AFP|Header files may need to be manually installed. Autoconf currently assumes install base of /usr (e.g. /usr/include/afpfs-ng)|

It should also be noted that, by default, not all of the modules are built. Incomplete modules or modules which have not been sufficiently tested may be disabled. The "configure" output should identify which modules it will attempt to build. To enable non-default modules, use the "--enable-module-MODULE_NAME" configure option.

#### Linux/Gentoo

At this time Medusa is not available within Portage. An ebuild for Medusa has been submitted to [bugs.gentoo.org](http://bugs.gentoo.org/), but has not yet made its way into Portage. In the meantime, all of the ebuilds can be used via Portage Overlay. For example, Medusa can be installed via the Gentoo "pentoo" overlay located at [trac.pentoo.ch](http://trac.pentoo.ch/). Additionally, the ebuilds have been included and can also be manually installed.

The following ebuilds have been included within this distribution:

- /misc/net-analyzer/medusa-2.1.ebuild

Some basic Portage Overlay instructions:  

- Modify /etc/make.conf  
    `PORTDIR_OVERLAY="/some/directory/"`
- Create the following within the PORTDIR_OVERLAY directory:  
    `net-analyzer/medusa`
- Place each ebuild and any accompanying files in its respective PORTDIR_OVERLAY directory.  
    cd into each directory and execute:  
    `ebuild name_of_ebuild.ebuild digest`
- Modify /etc/portage/package.keywords  
    `net-analyzer/medusa ~x86   `

#### MacOS

First download the source code and change to the Medusa directory:

git clone https://github.com/jmk-foofus/medusa
cd medusa

Also install the needed dependencies using Homebrew:

brew cask install xquartz
brew install freerdp

Then add the Freerdp path for executing the configuration without issues:

$ export FREERDP2_CFLAGS='-I/usr/local/include'
$ export FREERDP2_LIBS='-I/usr/local/lib/freerdp'

Then build things:

./configure
make && make install

Then copy the binary to your binaries folder

sudo cp src/medusa  /usr/local/bin

Now you can start using Medusa:

medusa

#### Other Systems

Medusa has been built and basic tests performed on a variety of default system installations. The following tables includes some notes from these tests.  
  

##### Medusa v2.3

|   |   |   |
|---|---|---|
|**Operating System**|**Distro/Version**|**Notes**|
|Linux|BackBox 8.1|Installed: automake, libssl-dev, libpq5, libpq-dev, libsmb2, libssh2-1, libssh2-1-dev, libsvn-dev, freerdp2-dev|
|Debian Sid (64-bit)|Installed: build-essential, automake, libssl-dev, libpq5, libpq-dev, libsmb2, libssh2-1, libssh2-1-dev, libsvn-dev, freerdp2-dev|
|Fedora 23|Installed: "Development Tools", automake, afpfs-ng-devel, libssh2-devel, libpq-devel, subversion-devel, freerdp-devel|
|Kali 2024.1 (64-bit)|Installed: automake, libssl-dev, libpq5, libpq-dev, libsmb2, libssh2-1, libssh2-1-dev, libsvn-dev, freerdp2-dev|
|Ubuntu 22.04 (64-bit, WSL)|Installed: build-essential, automake, libssl-dev, libpq5, libpq-dev, libsmb2, libssh2-1, libssh2-1-dev, libsvn-dev, freerdp2-dev|

##### Medusa v2.2 and earlier

|   |   |   |
|---|---|---|
|**Operating System**|**Distro/Version**|**Notes**|
|Linux|CentOS 7.1 (64-bit)|Installed: "Development Tools", openssl-devel, libssh2-devel, postgresql-devel, subversion-devel, freerdp-devel|
|Debian 8.0.0 (64-bit)|Installed: build-essential, libssl-dev, libpq5, libpq-dev, libssh2-1, libssh2-1-dev, libsvn-dev, freerdp, libfreerdp-dev, libncp, libncp-dev|
|Fedora 21|Installed: "Development Tools", afpfs-ng-devel, openssl-devel, libssh2-devel, postgresql-devel, subversion-devel, freerdp-devel|
|Kali 2020.4 (64-bit) [WSL]|Installed: build-essential, autoconf, libssl-dev, libpq5, libpq-dev, libssh2-1, libssh2-1-dev, libgnutls28-dev, libsvn-dev, freerdp2-dev|
|Mint 17|Installed: build-essential, libssl-dev, libpq5, libpq-dev, libssh2-1, libssh2-1-dev, libgcrypt11-dev, libgnutls-dev, libsvn-dev, freerdp, libfreerdp-dev|
|openSUSE 11.2|Installed: patterns-openSUSE-devel_C_C++, ncpfs-devel, libssh2-devel, postgresql-devel, subversion-devel|
|Ubuntu 20.04|Installed: build-essential, autoconf, libssl-dev, libpq5, libpq-dev, libssh2-1, libssh2-1-dev, libgnutls28-dev, libsvn-dev, freerdp2-dev|
|SunOS|Solaris 11 x86|Installed: developer-gnu|
|BSD|FreeBSD 7.2|Installed: afpfs-ng, ncpfs, libssh2, postgresql, libpq, libsvn|
|Mac OS X|OS X 10.11 (El Capitan)|Installed: Homebrew, XCode, "brew install freerdp --HEAD", "brew install libssh2 postgresql subversion"|
|Microsoft Windows|Cygwin|I have been unable to build the modules under Cygwin. If anyone can figure this out, I'll buy you a beer at the next DefCon.|

## Who?

This fine piece of buggy software was brought to you by the geeks at [Foofus.net](http://www.foofus.net/). JoMo-Kun was the chief goon and wrote the core of Medusa along with several of the modules. Foofus created the initial design for the loadable modules. Fizzgig provided the networking code, several modules, the loadable module implementation along with also fixing a bunch JoMo-Kun's crappy stuff. pMonkey was a crazy module coding fiend. Last, but certainly not least, Heidi provided the tool's name.

## Huh?

If you have questions regarding this application, feel free to contact us. Either send me email directly or join our mailing list [foofus-tools](http://lists.foofus.net/listinfo.cgi/foofus-tools-foofus.net). If it breaks, please send a detailed bug report. Even better, send in a patch. I make no claims that this program will do what you want it to. I've been using it during our assessments for years now successfully. Hopefully, others will have similar luck. If you find Medusa useful and want to give something back, please submit new modules, code improvements or just buy any of the [Foofus.net](http://www.foofus.net/) goons a beer at the next DefCon.

Joe  
  
**© Copyright 2024, Foofus Advanced Security Services**  
_any time. any fucknut._

**Credit:** This information was adapted from an excellent guide on [GitHub.io](https://jmk-foofus.github.io/medusa/medusa.html). Be sure to check out the original post for more details.

# A Detailed Guide on Medusa

[April 15, 2022](https://www.hackingarticles.in/a-detailed-guide-on-medusa/) by [Raj](https://www.hackingarticles.in/author/raj/)

Hi Pentesters! Let’s learn about a different tool Medusa, which is intended to be a speedy, parallel and modular, login brute forcer. The goal of the tool is to support as many services which allow remote authentication as possible. We can consider the following items to be some of the key features of the application.

1. **Thread-based parallel testing.** Brute-force testing can be performed against multiple hosts, users or passwords concurrently.
2. **Flexible user input**. Target information (host/user/password) can be specified in a variety of ways. For example, each item can be either a single entry or a file containing multiple entries. Additionally, a combination file format allows the user to refine their target listing.
3. **Modular design**. Each service module exists as an independent .mod file. This means that no modifications are necessary to the core application in order to extend the supported list of services for brute-forcing.

in This article will discuss the following options available with Medusa.

### Table of Contents

1. Features of Medusa
2. Password Cracking for specific Username
3. Username Cracking for specific Password
4. To crack login credentials
5. Brute Force on Multiple Host
6. To attack a specific port rather than the default
7. Additional password checks (Null/Same)
8. To Save Logs in a File
9. Stop on Success.
10. To suppress start-up Banner
11. Verbose Mode
12. Error Debug level
13. Using Combo Entries
14. Concurrent testing on multiple logins
15. Display Module Usage Information

### Features of Medusa

To get to know a detailed description of the options available in the Medusa tool just type in “medusa” in the kali terminal without any options, it will respectively dump all the available options with their description.

Syntax: Medusa [-h host|-H file] [-u username|-U file] [-p password|-P file] [-C file] – 0063M module [OPT]

![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEi_46Prg76BLUKSMVDBKGlwdmKk0yU1JfjmxtaY2YKAT3P_WS_jRGdRV6HYb7P7Mn4F8kD-5X_8AH8cEW53ncHkY0BVwt14WVDocxLITaMc8MdxSmgcqyERoO2OUwCOORNEcEt-d_2v7tXMDN2NmZDXreedqwOhl5BNoT_KuyR5MhaT3EFEn70mVTBi3w/s16000/1.png)

You can use -d option to dump all the available modules.

![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh2NT7tzDOo1UNGO3ZIihPJzwAoonn_DtMPz0EMbgykQDUDn88Kk4hIxb6d-eGaz73Z3NSoazbeICN_UaslV0L-C9AQKxq252xKjANylS4IHP_Zwt70dsgTYwLVrR0S7J02ZR5IpOh_C6BBGx9TNiR7IY-X3M0imsca0JGZazUHlm1uwpmSvQIEaimTyQ/s16000/2_1.png)

### Password Cracking for Specific Username

Being a brute forcer, we can use medusa to crack passwords if the username is known on any protocol. For this to work you should have a valid username and a file containing passwords to test.

So, for this following command can be used:

medusa -h 192.168.1.141 -u ignite -P pass.txt -M ftp

Here, -h option is for mentioning target ip address, -u option for username and -P for file containing password lists. So this will crack the password for FTP protocol.

![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhWZsGOdDxHt63_w-NvBscs3nXUS6r4euegnpCr_Td43V0Zqxzm749LHgnBd9TcF-Ca5_IAO0peuHNRYPj8f_0njfQDPDiAhbKBCY_pBlncutEiywoatBA4ZVXQnqGM6qT639YmiSxY6dTrMQ37zaqMHuyZKroOxaT-_Qjeoxa7ZS948kD6YrkOCs8Tug/s16000/3.png)

So, from the list of passwords, password 123 showed success for username ignite and for ftp login.

### Username Cracking for Specific Password

Again, for this you should have a correct password so that you can use brute force to crack the username for ftp by using a file containing list of usernames.

medusa -h 192.168.1.141 -U users.txt -p 123 -M ftp

Here -h option is used for host, -U option for username file and -p is for the password. So basically, you can perform brute force on the username field and can crack the correct username for the password.

**![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgkUHhaLF92IeeSJACVAK1ZhZjfICjNSYQs_WOOzVzwBoaG2yz6VFsJ_zR5J3HbEjJgtpZxMhHnem0BIez4h7OU-VZbjji89s5Ii-1P6KU25fIb6z34bEKoLP2804CqiGCrvKHSKD8mwRV9ePXUg4ZKMzaLk2tLipjTt0k2SoN8u0n7HgafiFRYbN9uUg/s16000/4.png)**

### To crack Login credentials

 Now let’s consider a situation where we want to target our host whose username and password both are not known. For this we will brute force both the fields username as well as password by using appropriate options present in medusa.

medusa -h 192.168.1.141 -U users.txt -P pass.txt -M ftp

Here we have used -U option for username file, -P option for password file and -h for host name. We have attached a screenshot for your better understanding.

**![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEifZcM84zu-u9f1kKkycVxXNP7JBZuQGRNOJGKV-yS47PVsWAJuq9KA_6d2zIb7xxCBJbNQBk8A48HJ-TqIjZs9u8oGLtxrUaBdSotcrYwwJEqFK9UaYbqxm2_ovW6ap0VmNseIOqtxCtohTa5wQh777T2HcyXMrIgb9Kb6_L8gX97unxKbmXvUIEXs2g/s16000/5.png)**

### Brute Force on Multiple Host

Now let’s consider a different situation, where we have multiple hosts, and we need to crack login credentials for the respective hosts. So, we have created three text files for host, username and password.

medusa -H hosts.txt -U user.txt -P pass.txt -M ftp

Here, -H option will mention file for host name, -U will mention file for username and -P will mention file for passwords.

![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhrwJZWHI4RnK4jmn9GFexbryXFMnqIYcwYFITcjDtsXK5qCOiMV5jUqVGvwNSJyl8HgbkO7dSUeg029COSkeDyyHdo2Eq1G-lESZDAHL8ju7U2kXUZ8Cr1JNN7jvGmVQ50iL5N0n6SHqbDyxLo-cPGBCSSElHqFrdRlVxxdkI2rZHlBr_pkv7lqHbjng/s16000/6.png)

If in case you have multiple hosts and you want to attack on some of the ports concurrently, for that you can use -T option which will brute force on some ports only.

medusa -H hosts.txt -U users.txt -P pass.txt -M ftp -T 1

medusa -H hosts.txt -U users.txt -P pass.txt -M ftp -T 2

The first command will brute force on first host only, but the second will attack on 2 hosts concurrently.

![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiY794fFjSYrLa11YBY93-TZnrFlqFFSjaQtkAajICC2YrtaYurRgJK7Sos3aAja5v6hw-l-b3Dx90A-vgmhKROk2PZQNFBC2U7gfkYqgDYGI3K_9e81YEzW795HSzsP9tfJuBvoP2_5JIkZ3BMOU-PJVPRAvciItHlgyDpljQEQ3xF8fsbZl2-dIvz1Q/s16000/7.png)

### To attack a specific port than default

Sometimes, the network admin may change the port number of service to another port due to security reasons. So, when performing a brute force attack using normal command so it will attack on default port. But we can use -n option so that attack will start on a mentioned port rather than the default port.

medusa -h 192.168.1.141 -U users.txt -P pass.txt -M ssh

medusa -h 192.168.1.141 -U users.txt -P pass.txt -M ssh -n 2222

Here, in the first command, we are using -h, -U and -M option and ssh service whose default port is 22. But due to security reasons, its port number is changed to 2222 as detected using the nmap scan and first command did not work. So, to launch the attack we used -n option which will specify the specific port number.

![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgAzv_rl6on66z9_205-MvQXpnY-x6KucXLnY7NAC2gkn54xbU82LlBq8sHNt07-gNmvZXE_nXi1uFnDNr5ESg-3Of-N_TqciUJfqFug9ZuejG8WsqlQq4Fsi5UD-J3q0TNngnkE6KZSb1v3W15y8A65ZSsqSS4rKPESRK3NDmBQG0XZEm_NHo91Uy2aA/s16000/8.png)

### Additional password checks (Null/Same)

Medusa has a great option -e along with ns which will check [n] null password, [s] the same password as username while brute forcing on the password field.

medusa -h 192.168.1.141 -u ignite -P pass.txt -M ftp -e ns

Here, as you can observe, -e option is used in the command so with every username It is trying to match the following combination of password with a username.

User: Ignite     Password: “ “ as null password.

User: Ignite     Password: “Ignite” same as username

![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgQnSUpAz8c4nijYS9VVvMnACTGm6h-CI4lErcUjd8JSCmb5SqviD_DOkruT-wMYsdqbEmRh9is7nWD0nH6hMpHrVVOkpzSa4S2KS4H-M52fIwdz5yut8wqCeOVDlu7nU5cdKhjHyKjDGw9Kzo8Y6WskgSnjJ31UW4MuI-rCGGbiGxh_5949mjhAMDZ5g/s16000/9.png)

### To Save Logs in a File

For better readability, record maintenance and future references we can save the output of the brute force attack of the medusa tool in a different text file. For this, we will use parameter -O to save output in text file.

medusa -h 192.168.1.141 -u ignite -P pass.txt -M ftp -O log.txt

Here, again the command is the same we have just added a new parameter -O to store the logs in text file log.txt. Then to ensure whether the output is stored in file, we have opened it using cat command. And the result shows the desired output.

![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh3GlyWtvkUoUzE2CYBgsv3RroyPxXDW6NGDAkRatK5wJBsHjL-ZALh6NmbTFg8Yklylb7qhZrO-i4uqrtZfjxg4oSgOftDsC_ZMN5Cql6UMDIbcXCI7AdWMgDC_bBDWR5aBGV0xFlUeB9G1MT76HvKKFrNqvofv4AYRRhSIC6N5xDN6xo-TsACA5yIhQ/s16000/10.png)

### Stop on Success

While using the above command, the attack will go on though we get the correct username and password, this may become tedious when the list of usernames and password is long.

So, to save from this medusa provides some options.

medusa -H hosts.txt -U users.txt -P pass.txt -M ftp -f

medusa -H hosts.txt -U users.txt -P pass.txt -M ftp -F

Above in the first command as you can observe -f option is used so that will stop scanning host after first valid username/password found.

![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjBnA1dkIHkeWpSURIO8PGwRnOa535SPfX7eocfrEWF0dWHbjcCBHK2vpEkkIYaSUo_--EeAZc9bLawsfyPq0DyaDgYm8DnXidNvkadLjfuo1c2xv3UqWUCnNWW6brasGicSfB7hY0Wch1Lzi-9dUERuK4UcKeBPa6oTP-KVG_dOMpCdKP1pf6HAjQULg/s16000/11.png)

And in the second command, -F option is used that will stop audit after first valid username/password found on any host.

![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhihbTdZkdC9Q6qScufTvXMdO2FWlhnHo5hHjn3zCH-eTifUFw-aFMQZPDVEBOE_MrhgkdbibllD10fJjVne8g4RgjnZR_qK-xPTuZhkMUPHLkMmkI18kONibXblYEe46g_MAul53O39a5eMByvc2MgSWu_pJnenUTEfcniNnHZxfBqEptg5XfQO3-ljw/s16000/12.png)

###  To suppress start-up Banner

Whenever you run medusa, always a start up banner is displayed. But this tool provides an option to remove the banner by using -b option.

medusa -h 192.168.1.141 -U users.txt -P pass.txt -M ftp -b

As in the screenshot displays, after applying -b option, the banner is suppressed.

![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhjeaNJnIbhXE_F-FeDwG4ma3-Gz8f54uJEKjG1wRea2BDCXZDV3R6eKxPwCY2LthboCydg-Jeum55lGjsMdpQNE7GuxPzihDvj_cKRGhJxApSmMlO8gu_AeKfLBchBa6tr5yECIap38Zm49tbRjR81UMCl-yNv7qeBed3R9IVszUZnBqQQLt5Jdue76w/s16000/13.png)

### Verbose Mode

This tool provides an option for verbose mode. There are in all six verbose level. All messages at or below the specified level will be displayed. The default level is 5. The following is the breakdown of the verbose levels:

0.EXIT APPLICATION

1.MESSAGE WITHOUT TAG

2.LOG MESSAGE WITHOUT TAG               

3.IMPORTANT MESSAGE

4.ACCOUNT FOUND

5.ACCOUNT CHECK

6.GENERAL MESSAGE

medusa -H hosts.txt -U users.txt -P pass.txt -M ftp -v

medusa -H hosts.txt -U users.txt -P pass.txt -M ftp -v 6

Here, in the given commands, verbose level 5 and level 6 is used. Level 5 performs account check and level 6 displays general message also.

![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgp8M0Bq0jVy6NWhNmsRnZe8vtGRyGjFhrnH_72rkPXuZSiF4ya1Q8IX__kQkyq1yIYWdEF9aZ2-u8dUYAagqDZ0bowSRhZKhqoVRUyE0mJS5dNZE3TGzcbNOBJOCox5EVpkmumQ86nBMlN7CzQtoePTb7bdHrLUzUENCCx7Um8eTGXxHYOBGMOxSdFlA/s16000/14.png)

### Error Debug level

This option is used to give detailed description of error. There are 10 error debug level. All messages at or below the specified level will be displayed. The default level is 5.

The following is the breakdown of the error levels:

0: FATAL

1: ALERT

2: CRITICAL                                       

3: ERROR                             

4: WARNING                                     

5: NOTICE

6: INFO                                                

7: DEBUG                                            

8: DEBUG-AUDIT                             

9: DEBUG- SERVER

10: DEBUG – MODULE

medusa -h 192.168.1.141 -U users.txt -P pass.txt -M ftp -w 0

medusa -h 192.168.1.141 -U users.txt -P pass.txt -M ftp -w 06

medusa -h 192.168.1.141 -U users.txt -P pass.txt -M ftp -w 07

![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiTPQb2w7vwj-4w9iVrex24-EERAxUHDhX8y6tB4zZyKN9GOaWny74GB-_4QIfhahuk4ocbqQOO2-kVPJfZ-AMIhvdLH9u2ChWoQiYeCEp6MgAN_ZNIfHnp4dYK37auWFMqYk3Hn34sKdL1hTxz2_N_lYdlWC1yDSZGU2nPSSPUdJS0mA17LSvl6QKj7A/s16000/15.png)

### Using Combo Entries

Medusa gives an option of using combo entries while brute forcing. The option -C uses a file containing combo entries. Combo files are colon separated and in the following format: host:user:password. If any of the three fields are left empty, the respective information should be provided either as single global value or as a list in a file. You can use following combinations.

host:user:password

host:user:

host::

username:password

username:

password

host::username

medusa -M ftp -C userpass.txt

So here first userpass.txt file is created where data is stored in form of host:username:password. And then medusa brute force attack is performed using -C option. You can take reference from screenshot attached.

![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgfGBlp7sZPZWGYx1TymPzeheLobq38-ANeKK6E0sFpCKOIibdprCK3hihkQbXyEBixkqXG9hI_SHQzlZ8GSG0XEd_TkGQx8b2e0z5ctdOaKEDR2QmEtlLY6HOIcEq5hnUPuQMSSjOU4F_wHMjB8WWx11aTh3mr2VwoPnSRyNw8yPt-xYg6_gE-_j1x9A/s16000/16.png)

### Concurrent testing on multiple logins

If you want to perform concurrent testing on multiple logins so for that you use -t option. After that mention the number of logins you want to test concurrently and hence medusa will brute force on respective logins.

medusa -h 192.168.1.141 -U users.txt -P pass.txt -M ftp -t 4

So, while performing the attack it tested concurrently 4 logins at specified port and printed results for all four concurrently.

![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEixT7WOCJbo2eYBwqrq3b2XLusdplUnxqyli5K1QiEvm3QzEtWcEl1sQ0Yi1bWzc8sqZrJX8eRMefoJNydxUFXkXSW2dnz9KsxCmJckHr_gph6LloAkTJPDkadyKf9Vm33E2R1nNsrXo_AG_hMichWqXIdQCRNfJp3bS6F3VV7Q7b2nt_EdtUH-OFMkaw/s16000/17.png)

### Display Module Usage Information

You can use a new option -q which will display module’s usage information. This should be used in conjunction with the “-M” option.

medusa -h 192.168.1.141 -U users.txt -P pass.txt -M ftp -q

![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiEL2iiRp_sGmZIQfcLVD0ZF_s6QxZNPyn9KBT6-cqeeh5xO0lghWVGfEs-4r2gwnKeMMO123MtWtoW15vW6BE7XX44TtYs5rgVnoMk4hsnxv2gWN8h9N4krue7tffr2Ra5Qb8fXvw82pv77tstT2GFS7qpAzBsvc7Qf1ntDJX4uiA6VJFtd-k6zZph_Q/s16000/18.png)

**Author**: Divya Adwani is a researcher and technical writer who is very much keen to learn and enthusiastic to learn ethical hacking Contact [**here**](https://www.linkedin.com/in/divya-adwani/)

**Credit:** This information was adapted from an excellent guide on [HackingArticles.in](https://www.hackingarticles.in/a-detailed-guide-on-medusa/). Be sure to check out the original post for more details.

<iframe width="560" height="315" src="https://www.youtube.com/embed/kadJLB2rYWo?si=oEzehRP703FjKWgU" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>

**Credit:** This information was adapted from an excellent guide on [YouTube](https://www.youtube.com/watch?v=kadJLB2rYWo). Be sure to check out the original post for more details.

<iframe width="560" height="315" src="https://www.youtube.com/embed/-CMBoJ60K1A?si=rFCwORwJI_Q5VZ75" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>

**Credit:** This information was adapted from an excellent guide on [YouTube](https://www.youtube.com/watch?v=-CMBoJ60K1A). Be sure to check out the original post for more details.

<iframe width="560" height="315" src="https://www.youtube.com/embed/ANE5qhZsm7U?si=ZT8G29A4EGAc8UZ5" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>

**Credit:** This information was adapted from an excellent guide on [YouTube](https://www.youtube.com/watch?v=ANE5qhZsm7U). Be sure to check out the original post for more details.

<iframe width="560" height="315" src="https://www.youtube.com/embed/7gYq0SSGxr4?si=UOiDRI7Zs7OqqmtA" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>

**Credit:** This information was adapted from an excellent guide on [YouTube](https://www.youtube.com/watch?v=7gYq0SSGxr4). Be sure to check out the original post for more details.


